<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Measure Memory API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2016/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 5c7bc9381, updated Wed May 12 18:18:08 2021 -0700" name="generator">
  <link href="https://wicg.github.io/performance-measure-memory/" rel="canonical">
  <meta content="1bc2904d4dba8c8c41019566ed4c9f2ec4855023" name="document-revision">
<style>
/* domintro from https://resources.whatwg.org/standard.css */
.domintro {
  position: relative;
  color: green;
  background: #DDFFDD;
  margin: 2.5em 0 2em 0;
  padding: 1.5em 1em 0.5em 2em;
}

.domintro dt, .domintro dt * {
  color: black;
  font-size: inherit;
}
.domintro dd {
  margin: 0.5em 0 1em 2em; padding: 0;
}
.domintro dd p {
  margin: 0.5em 0;
}
.domintro::before {
  content: 'For web developers (non-normative)';
  background: green;
  color: white;
  padding: 0.15em 0.25em;
  font-style: normal;
  position: absolute;
  top: -0.8em;
  left: -0.8em;
}
</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Measure Memory API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="2021-05-28">28 May 2021</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/performance-measure-memory/">https://wicg.github.io/performance-measure-memory/</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:ulan@google.com">Ulan Degenbaev</a> (<a class="p-org org" href="https://www.google.com/">Google</a>)
     <dt>Participate:
     <dd><a href="https://github.com/WICG/performance-measure-memory">GitHub WICG/performance-measure-memory</a> (<a href="https://github.com/WICG/performance-measure-memory/issues/new">new issue</a>, <a href="https://github.com/WICG/performance-measure-memory/issues?state=open">open issues</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2021 the Contributors to the Measure Memory API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines an API that allows web applications to measure their memory usage.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#data-model"><span class="secno">2</span> <span class="content">Data model</span></a>
     <ol class="toc">
      <li><a href="#memory-measurement-result"><span class="secno">2.1</span> <span class="content">Memory measurement result</span></a>
      <li><a href="#intermediate-memory-measurement-section"><span class="secno">2.2</span> <span class="content">Intermediate memory measurement</span></a>
      <li><a href="#memory-attribution-token-section"><span class="secno">2.3</span> <span class="content">Memory attribution token</span></a>
     </ol>
    <li>
     <a href="#processing-model"><span class="secno">3</span> <span class="content">Processing model</span></a>
     <ol class="toc">
      <li><a href="#extensions-to-performance"><span class="secno">3.1</span> <span class="content">Extensions to the <code class="idl"><span>Performance</span></code> interface</span></a>
      <li><a href="#top-level-algorithms"><span class="secno">3.2</span> <span class="content">Top-level algorithms</span></a>
      <li><a href="#converting-an-intermediate-memory-measurement-to-the-result"><span class="secno">3.3</span> <span class="content">Converting an intermediate memory measurement to the result</span></a>
      <li><a href="#creating-or-obtaining-a-memory-attribution-token"><span class="secno">3.4</span> <span class="content">Creating or obtaining a memory attribution token</span></a>
     </ol>
    <li>
     <a href="#integration-with-the-existing-specification"><span class="secno">4</span> <span class="content">Integration with the existing specification</span></a>
     <ol class="toc">
      <li><a href="#extension-to-window-or-worker-global-scope"><span class="secno">4.1</span> <span class="content">Extension to <code class="idl"><span>WindowOrWorkerGlobalScope</span></code></span></a>
      <li><a href="#extensions-to-the-existing-algorithms"><span class="secno">4.2</span> <span class="content">Extensions to the existing algorithms</span></a>
     </ol>
    <li>
     <a href="#privacy-and-security"><span class="secno">5</span> <span class="content">Privacy and Security</span></a>
     <ol class="toc">
      <li><a href="#information-leak"><span class="secno">5.1</span> <span class="content">Cross-origin information leak</span></a>
      <li><a href="#fingerprinting"><span class="secno">5.2</span> <span class="content">Fingerprinting</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">6</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <div nonnormative>
     The tradeoff between memory and performance is inherent in many algorithms and data-structures.
Web developers today have multiple ways to measure the timing information and no standard way to measure the memory usage.
This specification defines a <code class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory">performance.measureUserAgentSpecificMemory()</a></code> API that estimates the memory usage of the web application including all its iframes and workers.
The new API is intended for aggregating memory usage data from production. The main use cases are: 
    <ul>
     <li data-md>
      <p>Regression detection during rollout of a new version of the web application to catch new memory leaks.</p>
     <li data-md>
      <p>A/B testing a new feature to evaluate its memory impact.</p>
     <li data-md>
      <p>Correlating memory usage with user metrics to understand the overall impact of memory usage. </p>
    </ul>
   </div>
   <p></p>
   <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
   <div class="example" id="example-simple-page">
    <a class="self-link" href="#example-simple-page"></a> 
    <p>A <code class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory①">performance.measureUserAgentSpecificMemory()</a></code> call returns a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise">Promise</a></code> and starts
an asynchronous measurement of the memory allocated by the page.</p>
<pre class="language-javascript highlight"><c- k>async</c-> <c- a>function</c-> run<c- p>()</c-> <c- p>{</c->
  <c- a>const</c-> result <c- o>=</c-> <c- k>await</c-> performance<c- p>.</c->measureUserAgentSpecificMemory<c- p>();</c->
  console<c- p>.</c->log<c- p>(</c->result<c- p>);</c->
<c- p>}</c->
run<c- p>();</c->
</pre>
    <p>For a simple page without iframes and workers the result might look as follows:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Here all memory is attributed to the main page.
The entry with <code>bytes: 0</code> is present in the breakdown list to encourage processing of the result in a generic way without hardcoding specific entries.
Such an entry is inserted at a random position if the list is not empty. 
    <p>Other possible valid results:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[],</c->
<c- p>}</c->
</pre>
    Here the implementation provides only the total memory usage. 
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Here the implementation does not break memory down by memory types. 
   </div>
   <div class="example" id="example-same-origin-iframe">
    <a class="self-link" href="#example-same-origin-iframe"></a> 
    <p>For a page that embeds a same-origin iframe the result might attribute some memory
to that iframe and provide diagnostic information for identifying the iframe:</p>
<pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"redirect.html?target=iframe.html"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1500000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe.html"</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"redirect.html?target=iframe.html"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>}</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Note how the <code>url</code> and <code>container.src</code> fields differ for the iframe.
The former reflects the current <code>location.href</code> of the iframe whereas the
latter is the value of the <code>src</code> attribute of the iframe element. 
    <p>It is not always possible to separate iframe memory from page memory in a
meaningful way.
An implementation is allowed to lump together some or all of iframe and page memory:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1500000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe.html"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"redirect.html?target=iframe.html"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>};</c->
</pre>
   </div>
   <div class="example" id="example-web-worker">
    <a class="self-link" href="#example-web-worker"></a> For a page that spawns a web worker the result includes the URL of the worker. 
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1800000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>800000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/worker.js"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"DedicatedWorkerGlobalScope"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>};</c->
</pre>
    An implementation might lump together worker and page memory. If a worker is
spawned by an iframe, then the worker’s attribution entry has a <code>container</code> field
corresponding to the iframe element. 
    <p>Memory of shared and service workers is not included in the result.</p>
   </div>
   <div class="example" id="example-shared-worker">
    <a class="self-link" href="#example-shared-worker"></a> To get the memory usage of a shared/service worker, the <code class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory②">performance.measureUserAgentSpecificMemory()</a></code> function needs to be invoked in the context of that worker.
The result could be something like: 
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/service-worker.js"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"ServiceWorkerGlobalScope"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
   </div>
   <div class="example" id="example-cross-origin-iframe">
    <a class="self-link" href="#example-cross-origin-iframe"></a> If a page embeds a cross-origin iframe, then the URL of that iframe is not
revealed to avoid information leaks. Only the container element
(which is already known to the page) appears in the result.
Additionally, if the cross-origin iframe embeds other cross-origin iframes
and/or spawns workers, then all their memory is aggregated and attributed to
the top-most cross-origin iframe. 
    <p>Consider a page with the following structure:</p>
<pre class="language-javascript highlight">example<c- p>.</c->com <c- p>(</c-><c- mf>1000000</c-> bytes<c- p>)</c->
  <c- o>|</c->
  <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe1 <c- p>(</c-><c- mf>500000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mf>200000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->bar<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mf>300000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->worker<c- p>.</c->js <c- p>(</c-><c- mf>400000</c-> bytes<c- p>)</c->
</pre>
    A cross-origin iframe embeds to other iframes and spawns a worker.
All memory of these resources is attributed to the first iframe. 
<pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://foo.com/iframe1"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>2400000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1400000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Note that the <code>url</code> and <code>scope</code> fields of the cross-origin iframe entry have
special values indicating that information is not available. 
    <p>If the implementation loads cross-origin iframes in a different address space,
then their memory usage is not measured.
The breakdown entries of such iframes have <code>bytes: 0</code> indicating that these
iframes are not accounted for:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>100000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
   </div>
   <div class="example" id="example-same-and-cross-origin-iframes">
    <a class="self-link" href="#example-same-and-cross-origin-iframes"></a> If a cross-origin iframe embeds an iframe of the same origin as the main page,
then the same-origin iframe is revealed in the result.
Note that there is no information leak because the main page can find and read <code>location.href</code> of the same-origin iframe. 
<pre class="language-javascript highlight">example<c- p>.</c->com <c- p>(</c-><c- mf>1000000</c-> bytes<c- p>)</c->
  <c- o>|</c->
  <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe1 <c- p>(</c-><c- mf>500000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->example<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mf>200000</c-> bytes<c- p>)</c->
</pre>
<pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://foo.com/iframe1"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1700000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>200000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe2"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    <p>If the implementation omits memory measurement of cross-origin iframes,
then the result could look like:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1200000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>200000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe2"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
   </div>
   <h2 class="heading settled" data-level="2" id="data-model"><span class="secno">2. </span><span class="content">Data model</span><a class="self-link" href="#data-model"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="memory-measurement-result"><span class="secno">2.1. </span><span class="content">Memory measurement result</span><a class="self-link" href="#memory-measurement-result"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory③">performance.measureUserAgentSpecificMemory()</a></code> function returns a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①">Promise</a></code> that resolves to an instance of <code class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement">MemoryMeasurement</a></code> dictionary:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memorymeasurement"><code><c- g>MemoryMeasurement</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryMeasurement" data-dfn-type="dict-member" data-export data-type="unsigned long long " id="dom-memorymeasurement-bytes"><code><c- g>bytes</c-></code></dfn>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry"><c- n>MemoryBreakdownEntry</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryMeasurement" data-dfn-type="dict-member" data-export data-type="sequence<MemoryBreakdownEntry> " id="dom-memorymeasurement-breakdown"><code><c- g>breakdown</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>measurement . <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes">bytes</a></code></code>
     <dd data-md>
      <p>A number that represents the total memory usage.</p>
     <dt data-md><code>measurement . <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-breakdown" id="ref-for-dom-memorymeasurement-breakdown">breakdown</a></code></code>
     <dd data-md>
      <p>An array that partitions the total <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes①">bytes</a></code> and provides attribution and type information. </p>
    </dl>
    <p></p>
   </dl>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memorybreakdownentry"><code><c- g>MemoryBreakdownEntry</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long①"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="unsigned long long " id="dom-memorybreakdownentry-bytes"><code><c- g>bytes</c-></code></dfn>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence①"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution"><c- n>MemoryAttribution</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="sequence<MemoryAttribution> " id="dom-memorybreakdownentry-attribution"><code><c- g>attribution</c-></code></dfn>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence②"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="sequence<DOMString> " id="dom-memorybreakdownentry-types"><code><c- g>types</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes">bytes</a></code></code>
     <dd data-md>
      <p>The size of the memory that this entry describes.</p>
     <dt data-md><code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution">attribution</a></code></code>
     <dd data-md>
      <p>An array of URLs and/or container elements of the <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms">JavaScript realms</a> that use the memory.</p>
     <dt data-md><code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-types" id="ref-for-dom-memorybreakdownentry-types">types</a></code></code>
     <dd data-md>
      <p>An array of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> memory types associated with the memory. </p>
    </dl>
    <p></p>
   </dl>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memoryattribution"><code><c- g>MemoryAttribution</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-memoryattribution-url"><code><c- g>url</c-></code></dfn>;
  <a data-link-type="idl-name" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer"><c- n>MemoryAttributionContainer</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="MemoryAttributionContainer " id="dom-memoryattribution-container"><code><c- g>container</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-memoryattribution-scope"><code><c- g>scope</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url">url</a></code></code>
     <dd data-md>
      <p>If this attribution corresponds to a same-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①">JavaScript realm</a>, then this field contains realm’s URL.
 Otherwise, the attribution is for one or more cross-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms②">JavaScript realms</a> and this field contains
 a sentinel value: <code>"cross-origin-url"</code>.</p>
     <dt data-md><code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container">container</a></code></code>
     <dd data-md>
      <p>Describes the DOM element that (maybe indirectly) contains the <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms③">JavaScript realms</a>.
 This property might be absent if the attribution is for the same-origin top-level realm.
 Note that cross-origin realms cannot be top-level due to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability">cross-origin isolation</a>.</p>
     <dt data-md><code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope">scope</a></code></code>
     <dd data-md>
      <p>Describes the type of the same-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms④">JavaScript realm</a>: <code>"Window", "DedicatedWorkerGlobalScope", "SharedWorkerGlobalScope", "ServiceWorkerGlobalScope"</code> or <code>"cross-origin-aggregated"</code> for the cross-origin case. </p>
    </dl>
    <p></p>
   </dl>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memoryattributioncontainer"><code><c- g>MemoryAttributionContainer</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttributionContainer" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-memoryattributioncontainer-id"><code><c- g>id</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttributionContainer" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-memoryattributioncontainer-src"><code><c- g>src</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>container . <code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id">id</a></code></code>
     <dd data-md>
      <p>The <code>id</code> attribute of the container element.</p>
     <dt data-md><code>container . <code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src">src</a></code></code>
     <dd data-md>
      <p>The <code>src</code> attribute of the container element. If the container element is an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element">object</a></code> element,
 then this field contains the value of the <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data">data</a></code> attribute.</p>
    </dl>
    <p></p>
   </dl>
   <h3 class="heading settled" data-level="2.2" id="intermediate-memory-measurement-section"><span class="secno">2.2. </span><span class="content">Intermediate memory measurement</span><a class="self-link" href="#intermediate-memory-measurement-section"></a></h3>
   <p>This specification assumes the existence of an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①">implementation-defined</a> algorithm that measures
the memory usage of the given set of <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters">agent clusters</a> in the address space of the given current <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters①">agent cluster</a>.
The result of such an algorithm is an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="intermediate-memory-measurement">intermediate memory measurement</dfn>,
which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">set</a> of <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry">intermediate memory breakdown entries</a>.</p>
   <p>To preserve security guarantees of address space isolation, any intermediate memory breakdown entries that represent memory outside the current address space must have their bytes set to 0.</p>
   <p>To reduce fingerprinting risks the result must include only the memory related to the web platform objects allocated or used by the given set of agent clusters.
This, for example, excludes the memory of user-agent-specific extensions and the baseline memory of an empty page.
The memory must be accounted at the address space level to exclude any platform-specific memory optimizations such memory compression and lazy memory committing.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry">intermediate memory breakdown entry</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> containing the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry-bytes">bytes</dfn>
    <dd data-md>
     <p>The size of the memory that this <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry①">intermediate memory breakdown entry</a> describes, or 0 if this entry represents memory outside the current address space.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry-realms">realms</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">set</a> of <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑤">JavaScript realms</a> to which the memory is attributed to.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry-types">types</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">set</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">strings</a> specifying <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined②">implementation-defined</a> memory types associated with the memory.</p>
   </dl>
   <p>Algorithms defined in this specification show how to convert an <a data-link-type="dfn" href="#intermediate-memory-measurement" id="ref-for-intermediate-memory-measurement">intermediate memory measurement</a> to an instance of <code class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement①">MemoryMeasurement</a></code>.</p>
   <h3 class="heading settled" data-level="2.3" id="memory-attribution-token-section"><span class="secno">2.3. </span><span class="content">Memory attribution token</span><a class="self-link" href="#memory-attribution-token-section"></a></h3>
   <p>The link between an embedded <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑥">JavaScript realm</a> and its container element is ephemeral and is not guaranteed to always exist.
For example, navigation to another document in the container element or removal of the container element from the DOM tree severs the link.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="memory-attribution-token">memory attribution token</dfn> provides a way to get from a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑦">JavaScript realm</a> to its container element.
It is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> containing the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item①">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="memory attribution token" data-dfn-type="dfn" data-noexport id="memory-attribution-token-container">container</dfn>
    <dd data-md>
     <p>An instance of <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer①">MemoryAttributionContainer</a></code>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="memory attribution token" data-dfn-type="dfn" data-noexport id="memory-attribution-token-cross-origin-aggregated-flag">cross-origin aggregated flag</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean">boolean</a> flag indicating whether the token was created for aggregating the memory usage of
 cross-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑧">JavaScript realms</a>.</p>
   </dl>
   <p>It is stored in a new internal field of <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> at construction time and is always available for memory reporting.</p>
   <h2 class="heading settled" data-level="3" id="processing-model"><span class="secno">3. </span><span class="content">Processing model</span><a class="self-link" href="#processing-model"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="extensions-to-performance"><span class="secno">3.1. </span><span class="content">Extensions to the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#sec-performance" id="ref-for-sec-performance">Performance</a></code> interface</span><a class="self-link" href="#extensions-to-performance"></a></h3>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/hr-time/#sec-performance" id="ref-for-sec-performance①"><c- g>Performance</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>ServiceWorker</c->,<c- n>SharedWorker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://github.com/heycam/webidl#pull/883" id="ref-for-pull/883"><c- g>CrossOriginIsolated</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement②"><c- n>MemoryMeasurement</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory④"><c- g>measureUserAgentSpecificMemory</c-></a>();
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>performance . <code class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory⑤">measureUserAgentSpecificMemory()</a></code></code>
     <dd data-md>
      <p>A method that performs an asynchronous memory measurement. Details about the result of the method are in <a href="#memory-measurement-result">§ 2.1 Memory measurement result</a>. </p>
    </dl>
    <p></p>
   </dl>
   <h3 class="heading settled" data-level="3.2" id="top-level-algorithms"><span class="secno">3.2. </span><span class="content">Top-level algorithms</span><a class="self-link" href="#top-level-algorithms"></a></h3>
   <div class="algorithm" data-algorithm="measureUserAgentSpecificMemory()" data-algorithm-for="Performance">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="Performance" data-dfn-type="method" data-export id="dom-performance-measureuseragentspecificmemory"><code>measureUserAgentSpecificMemory()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent">the current Realm</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object">settings objects</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability①">cross-origin isolated capability</a> is true.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="#memory-measurement-allowed-predicate" id="ref-for-memory-measurement-allowed-predicate">memory measurement allowed predicate</a> given <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent①">the current Realm</a> is false, then:</p>
      <ol>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with">a promise rejected with</a> a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror" id="ref-for-securityerror">SecurityError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>.</p>
      </ol>
     <li data-md>
      <p>Let <var>the current agent cluster</var> be <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent②">the current Realm</a>'s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agents" id="ref-for-sec-agents">agent</a>'s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters②">agent cluster</a>.</p>
     <li data-md>
      <p>Let <var>agent clusters</var> be the result of <a data-link-type="dfn" href="#getting-all-agent-clusters" id="ref-for-getting-all-agent-clusters">getting all agent clusters</a> given <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent③">the current Realm</a>.</p>
     <li data-md>
      <p>Let <var>promise</var> be a new <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise③">Promise</a></code>.</p>
     <li data-md>
      <p>Start asynchronous <a data-link-type="dfn" href="#implementation-defined-memory-measurement" id="ref-for-implementation-defined-memory-measurement">implementation-defined memory measurement</a> given <var>the current agent cluster</var>, <var>agent clusters</var>, and <var>promise</var>.</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="memory measurement allowed predicate">
     To evaluate <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="memory-measurement-allowed-predicate">memory measurement allowed predicate</dfn> given a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑨">JavaScript realm</a> <var>realm</var>: 
    <ol>
     <li data-md>
      <p>Let <var>global object</var> be <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global">global object</a>.</p>
     <li data-md>
      <p>If <var>global object</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope">SharedWorkerGlobalScope</a></code>, then return true.</p>
     <li data-md>
      <p>If <var>global object</var> is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope">ServiceWorkerGlobalScope</a></code>, then return true.</p>
     <li data-md>
      <p>If <var>global object</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window">Window</a></code> then</p>
      <ol>
       <li data-md>
        <p>Let <var>settings object</var> be <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①">settings object</a>.</p>
       <li data-md>
        <p>If <var>settings object</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin">origin</a> is the same as <var>settings object</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-origin">top-level origin</a>, then return true.</p>
      </ol>
     <li data-md>
      <p>Return false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="getting all agent clusters">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="getting all agent clusters|get all agent clusters" data-noexport id="getting-all-agent-clusters">get all agent clusters</dfn> given an <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①⓪">JavaScript realm</a> <var>realm</var>: 
    <ol>
     <li data-md>
      <p>If <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①">global object</a> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window①">Window</a></code>, then:</p>
      <ol>
       <li data-md>
        <p>Let <var>group</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group" id="ref-for-browsing-context-group">browsing context group</a> that contains <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②">global object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#window-bc" id="ref-for-window-bc">browsing context</a>.</p>
       <li data-md>
        <p>Return the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-values" id="ref-for-map-getting-the-values">getting the values</a> of <var>group</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#agent-cluster-map" id="ref-for-agent-cluster-map">agent cluster map</a>.</p>
      </ol>
     <li data-md>
      <p>Return « <var>realm</var>’s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agents" id="ref-for-sec-agents①">agent</a>'s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters③">agent cluster</a> ».</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="implementation-defined memory measurement">
     To perform <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="implementation-defined-memory-measurement">implementation-defined memory measurement</dfn> given given an <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters④">agent cluster</a> <var>the current agent cluster</var>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set③">set</a> of <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters⑤">agent clusters</a> <var>agent clusters</var>, and
  a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise④">Promise</a></code> <var>promise</var> run these steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>: 
    <ol>
     <li data-md>
      <p>Let <var>intermediate memory measurement</var> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined③">implementation-defined</a> <a data-link-type="dfn" href="#intermediate-memory-measurement" id="ref-for-intermediate-memory-measurement①">intermediate memory measurement</a> performed for <var>the current agent cluster</var> and <var>agent clusters</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task">Queue a global task</a> on the TODO task source given <var>promise</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve">resolve</a> <var>promise</var> with the result of <a data-link-type="dfn" href="#creating-a-new-memory-measurement" id="ref-for-creating-a-new-memory-measurement">creating a new memory measurement</a> given <var>intermediate memory measurement</var>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.3" id="converting-an-intermediate-memory-measurement-to-the-result"><span class="secno">3.3. </span><span class="content">Converting an intermediate memory measurement to the result</span><a class="self-link" href="#converting-an-intermediate-memory-measurement-to-the-result"></a></h3>
   <div class="algorithm" data-algorithm="creating a new memory measurement">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="creating a new memory measurement|create a new memory measurement" data-noexport id="creating-a-new-memory-measurement">create a new memory measurement</dfn> given an <a data-link-type="dfn" href="#intermediate-memory-measurement" id="ref-for-intermediate-memory-measurement②">intermediate memory measurement</a> <var>intermediate measurement</var>: 
    <ol>
     <li data-md>
      <p>Let <var>bytes</var> be 0.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry②">intermediate memory breakdown entry</a> <var>intermediate entry</var> in <var>intermediate measurement</var>:</p>
      <ol>
       <li data-md>
        <p>Set <var>bytes</var> to <var>bytes</var> plus <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-bytes" id="ref-for-intermediate-memory-breakdown-entry-bytes">bytes</a>.</p>
      </ol>
     <li data-md>
      <p>Let <var>breakdown</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> to <var>breakdown</var> a new <code class="idl"><a data-link-type="idl" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry①">MemoryBreakdownEntry</a></code> whose:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes①">bytes</a></code> is 0,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution①">attribution</a></code> is « »,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-types" id="ref-for-dom-memorybreakdownentry-types①">types</a></code> is « ».</p>
      </ul>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate①">For each</a> <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry③">intermediate memory breakdown entry</a> <var>intermediate entry</var> in <var>intermediate measurement</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>breakdown entry</var> be the result of <a data-link-type="dfn" href="#creating-a-new-memory-breakdown-entry" id="ref-for-creating-a-new-memory-breakdown-entry">creating a new memory breakdown entry</a> given <var>intermediate entry</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">Append</a> <var>breakdown entry</var> to <var>breakdown</var>.</p>
      </ol>
     <li data-md>
      <p>Randomize the order of the items in <var>breakdown</var>.</p>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement③">MemoryMeasurement</a></code> whose:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes②">bytes</a></code> is <var>bytes</var>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-breakdown" id="ref-for-dom-memorymeasurement-breakdown①">breakdown</a></code> is <var>breakdown</var>.</p>
      </ul>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="creating a new memory breakdown entry">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="creating a new memory breakdown entry|create a new memory breakdown entry" data-noexport id="creating-a-new-memory-breakdown-entry">create a new memory breakdown entry</dfn> given an <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry④">intermediate memory breakdown entry</a> <var>intermediate entry</var>: 
    <ol>
     <li data-md>
      <p>Let <var>attribution</var> a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate②">For each</a> <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①①">JavaScript realm</a> <var>realm</var> in <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-realms" id="ref-for-intermediate-memory-breakdown-entry-realms">realms</a>:</p>
      <ol>
       <li data-md>
        <p>Let <var>attribution entry</var> be the result of <a data-link-type="dfn" href="#creating-a-new-memory-attribution" id="ref-for-creating-a-new-memory-attribution">creating a new memory attribution</a> given <var>realm</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append②">Append</a> <var>attribution entry</var> to <var>attribution</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>types</var> be <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-types" id="ref-for-intermediate-memory-breakdown-entry-types">types</a>.</p>
     <li data-md>
      <p>Randomize the order of the items in <var>types</var>.</p>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry②">MemoryBreakdownEntry</a></code> whose:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes②">bytes</a></code> is <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-bytes" id="ref-for-intermediate-memory-breakdown-entry-bytes①">bytes</a>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution②">attribution</a></code> is <var>attribution</var>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-types" id="ref-for-dom-memorybreakdownentry-types②">types</a></code> is <var>types</var>.</p>
      </ul>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="creating a new memory attribution">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="creating a new memory attribution|create a new memory attribution" data-noexport id="creating-a-new-memory-attribution">create a new memory attribution</dfn> given a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①②">JavaScript realm</a> <var>realm</var>: 
    <ol>
     <li data-md>
      <p>Let <var>token</var> be <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global③">global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token">memory attribution token</a>.</p>
     <li data-md>
      <p>If <var>token</var>’s <a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag">cross-origin aggregated flag</a> is true, then</p>
      <ol>
       <li data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution①">MemoryAttribution</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url①">url</a></code> is "<code>cross-origin-url</code>",</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container①">container</a></code> is <var>token</var>’s <a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container">container</a> if it is not null; otherwise, the <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container②">container</a></code> entry is omitted,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope①">scope</a></code> is "<code>cross-origin-aggregated</code>".</p>
        </ul>
      </ol>
     <li data-md>
      <p>Let <var>scope name</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-identifier" id="ref-for-dfn-identifier">identifier</a> of <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global④">global object</a>'s <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-interface" id="ref-for-dfn-interface">interface</a>.</p>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution②">MemoryAttribution</a></code> whose:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url②">url</a></code> is <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object②">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" id="ref-for-concept-environment-creation-url">creation URL</a>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container③">container</a></code> is <var>token</var>’s <a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container①">container</a> if it is not null, otherwise, the <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container④">container</a></code> entry is omitted,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope②">scope</a></code> is <var>scope name</var>.</p>
      </ul>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.4" id="creating-or-obtaining-a-memory-attribution-token"><span class="secno">3.4. </span><span class="content">Creating or obtaining a memory attribution token</span><a class="self-link" href="#creating-or-obtaining-a-memory-attribution-token"></a></h3>
   <div class="algorithm" data-algorithm="obtain a window memory attribution token">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="obtain a window memory attribution token|obtaining a window memory attribution token" data-noexport id="obtain-a-window-memory-attribution-token">obtain a window memory attribution token</dfn> given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin">origin</a> <var>origin</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin①">origin</a> <var>parent origin</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin②">origin</a> <var>top-level origin</var>,
  an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement" id="ref-for-htmlelement">HTMLElement</a></code> <var>container element</var>, and a <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token">memory attribution token</a> <var>parent token</var>: 
    <ol>
     <li data-md>
      <p>If <var>container element</var> is null, then:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①">Assert</a>: <var>parent origin</var> is null.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert②">Assert</a>: <var>parent token</var> is null.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert③">Assert</a>: <var>origin</var> is equal to <var>parent origin</var></p>
       <li data-md>
        <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token①">memory attribution token</a> whose:</p>
        <ul>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container②">container</a> is null,</p>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag①">cross-origin aggregated flag</a> is false.</p>
        </ul>
      </ol>
     <li data-md>
      <p>If <var>parent origin</var> is not equal to <var>top-level origin</var>, then:</p>
      <ol>
       <li data-md>
        <p>Return <var>parent token</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>container</var> be the result of <a data-link-type="dfn" href="#extract-container-element-attributes" id="ref-for-extract-container-element-attributes">extracting container element attributes</a> given <var>container element</var>.</p>
     <li data-md>
      <p>If <var>origin</var> is equal to <var>top-level origin</var>, then:</p>
      <ol>
       <li data-md>
        <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token②">memory attribution token</a> whose:</p>
        <ul>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container③">container</a> is <var>container</var>,</p>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag②">cross-origin aggregated flag</a> is false.</p>
        </ul>
      </ol>
     <li data-md>
      <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token③">memory attribution token</a> whose:</p>
      <ul>
       <li data-md>
        <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container④">container</a> is <var>container</var>,</p>
       <li data-md>
        <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag③">cross-origin aggregated flag</a> is true.</p>
      </ul>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="obtain a worker memory attribution token">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="obtain a worker memory attribution token|obtaining a worker memory attribution token" data-noexport id="obtain-a-worker-memory-attribution-token">obtain a worker memory attribution token</dfn> given <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code> <var>worker global scope</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> <var>outside settings</var>: 
    <ol>
     <li data-md>
      <p>If <var>worker global scope</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a></code>, then
 return <var>outside settings</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token①">memory attribution token</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>worker global scope</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①">SharedWorkerGlobalScope</a></code> or a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①">ServiceWorkerGlobalScope</a></code>.</p>
     <li data-md>
      <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token④">memory attribution token</a> whose:</p>
      <ul>
       <li data-md>
        <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container⑤">container</a> is null,</p>
       <li data-md>
        <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag④">cross-origin aggregated flag</a> is false.</p>
      </ul>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="extract container element attributes">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="extract container element attributes|extracting container element attributes" data-noexport id="extract-container-element-attributes">extract container element attributes</dfn> given an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement" id="ref-for-htmlelement①">HTMLElement</a></code> <var>container element</var>: 
    <ol>
     <li data-md>
      <p>Switch on <var>container element</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element-local-name" id="ref-for-concept-element-local-name">local name</a>:</p>
      <dl class="switch">
       <dt data-md>"iframe"
       <dd data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer②">MemoryAttributionContainer</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id①">id</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute">id</a></code> attribute,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src①">src</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src" id="ref-for-attr-iframe-src">src</a></code> attribute,</p>
        </ul>
       <dt data-md>"frame"
       <dd data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer③">MemoryAttributionContainer</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id②">id</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute①">id</a></code> attribute,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src②">src</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-frame-src" id="ref-for-dom-frame-src">src</a></code> attribute,</p>
        </ul>
       <dt data-md>"object"
       <dd data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer④">MemoryAttributionContainer</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id③">id</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute②">id</a></code> attribute,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src③">src</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data①">data</a></code> attribute,</p>
        </ul>
      </dl>
    </ol>
   </div>
   <h2 class="heading settled" data-level="4" id="integration-with-the-existing-specification"><span class="secno">4. </span><span class="content">Integration with the existing specification</span><a class="self-link" href="#integration-with-the-existing-specification"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="extension-to-window-or-worker-global-scope"><span class="secno">4.1. </span><span class="content">Extension to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope①">WindowOrWorkerGlobalScope</a></code></span><a class="self-link" href="#extension-to-window-or-worker-global-scope"></a></h3>
    A new internal field is added to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope②">WindowOrWorkerGlobalScope</a></code>: 
   <dl>
    <dt data-md>A <dfn class="dfn-paneled" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="dfn" data-noexport id="windoworworkerglobalscope-memory-attribution-token">memory attribution token</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token⑤">memory attribution token</a> that is used for reporting the memory usage of this environment.</p>
   </dl>
   <h3 class="heading settled" data-level="4.2" id="extensions-to-the-existing-algorithms"><span class="secno">4.2. </span><span class="content">Extensions to the existing algorithms</span><a class="self-link" href="#extensions-to-the-existing-algorithms"></a></h3>
   <p>The <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker" id="ref-for-run-a-worker">run a worker</a> algorithm sets
the <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token②">memory attribution token</a> field of the newly created global object in step 6:</p>
   <blockquote>
    <ol start="6">
     <li data-md>
      <p>Let realm execution context be the result of creating a new JavaScript realm given agent
 and the following customizations:</p>
      <ul>
       <li data-md>
        <p>...</p>
       <li data-md>
        <p>Set global object’s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token③">memory attribution token</a> to the result of <a data-link-type="dfn" href="#obtain-a-worker-memory-attribution-token" id="ref-for-obtain-a-worker-memory-attribution-token">obtaining a worker memory attribution token</a> given
 the global object and <var>outside settings</var>.</p>
      </ul>
    </ol>
   </blockquote>
   <p>The <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object" id="ref-for-initialise-the-document-object">create and initialize a Document object</a> algorithm sets the <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token④">memory attribution token</a> field of the newly created global object:</p>
   <blockquote>
    <ol start="7">
     <li data-md>
      <p>Otherwise:</p>
      <ol start="5">
       <li data-md>
        <p>Let <var>token</var> be an empty <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token⑥">memory attribution token</a>.</p>
       <li data-md>
        <p>If <var>browsingContext</var> is not a top-level browsing context, then:</p>
        <ol start="4">
         <li data-md>
          <p>Let <var>parentToken</var> be <var>parentEnvironment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①">global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑤">memory attribution token</a>.</p>
         <li data-md>
          <p>Set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token">obtaining a window memory attribution token</a> with <var>origin</var>, <var>parentEnvironment</var>’s origin, <var>topLevelOrigin</var>, <var>browsingContext</var>’s container, <var>parentToken</var>.</p>
        </ol>
       <li data-md>
        <p>Else, set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token①">obtaining a window memory attribution token</a> with <var>origin</var>, null <var>topLevelOrigin</var>, null, null.</p>
       <li data-md>
        <p>Let <var>window global scope</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑤">global object</a> of <var>realm execution context</var>’s Realm component.</p>
       <li data-md>
        <p>Set <var>window global scope</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑥">memory attribution token</a> to <var>token</var>.</p>
      </ol>
    </ol>
   </blockquote>
   <p>The <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/browsers.html#creating-a-new-browsing-context" id="ref-for-creating-a-new-browsing-context">create a new browsing context</a> algorithm sets the <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑦">memory attribution token</a> field of the newly created global object:</p>
   <blockquote>
    <ol start="11">
     <li data-md>
      <p>Let <var>token</var> be an empty token.</p>
     <li data-md>
      <p>If <var>embedder</var> is null, then set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token②">obtaining a window memory attribution token</a> with <var>origin</var>,
  null, <var>topLevelOrigin</var>, null, null.</p>
     <li data-md>
      <p>Else, set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token③">obtaining a window memory attribution token</a> with <var>origin</var>, <var>embedder</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>'s origin, <var>topLevelOrigin</var>, <var>embedder</var>, <var>embedder</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑧">memory attribution token</a>.</p>
     <li data-md>
      <p>Let <var>window global scope</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑥">global object</a> of <var>realm execution context</var>’s Realm component.</p>
     <li data-md>
      <p>Set <var>window global scope</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑨">memory attribution token</a> to <var>token</var>.</p>
    </ol>
   </blockquote>
   <h2 class="heading settled" data-level="5" id="privacy-and-security"><span class="secno">5. </span><span class="content">Privacy and Security</span><a class="self-link" href="#privacy-and-security"></a></h2>
   <div nonnormative>
    <h3 class="heading settled" data-level="5.1" id="information-leak"><span class="secno">5.1. </span><span class="content">Cross-origin information leak</span><a class="self-link" href="#information-leak"></a></h3>
    <p>The URLs and other string values that appear in the result are guaranteed to be known to the origin that invokes the API.</p>
    <p>The only information that is exposed cross-origin is the size information provided in <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes③">memoryMeasurement.bytes</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes③">memoryBreakdownEntry.bytes</a></code>.
The API relies on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability②">cross-origin isolation</a> mechanism to mitigate cross-origin size information leaks.
Specifically, the API relies on the invariant that all resources in the current address space have opted in to be embeddable and legible by their embedding origin.
The API does not expose the sizes of cross-origin resources loaded in a different address space.</p>
    <h3 class="heading settled" data-level="5.2" id="fingerprinting"><span class="secno">5.2. </span><span class="content">Fingerprinting</span><a class="self-link" href="#fingerprinting"></a></h3>
    <p>The result of the API depends only on the objects allocated by the web page itself and does not include unrelated memory such as the baseline memory usage of an empty web page.
This means the same user agent binary running on two different devices should produce the same results for a fixed web page.</p>
    <p>A web page can infer the following information about the user agent:</p>
    <ul>
     <li data-md>
      <p>the bitness of the user agent (32-bit vs 64-bit).</p>
     <li data-md>
      <p>the version of the user agent to some extent.</p>
    </ul>
    <p>Similar information can be obtained from the existing APIs (<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent" id="ref-for-dom-navigator-useragent">navigator.userAgent</a></code>, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-platform" id="ref-for-dom-navigator-platform">navigator.platform</a></code>).
The bitness of the user agent can also be inferred by measuring the runtime of 32-bit and 64-bit operations.</p>
    <p>Currently the API is available only to the top-level origin.
In the future the top-level origin will be able to delegate the API to other origins using Permissions Policy.
In both cases, cross-origin iframes do not get access to the API by default.</p>
   </div>
   <h2 class="heading settled" data-level="6" id="acknowledgements"><span class="secno">6. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    Thanks to Domenic Denicola and Shu-yu Guo for contributing to the API design and for reviewing this specification. 
   <p>Also thanks to Adam Giacobbe, Anne van Kesteren, Artur Janc, Boris Zbarsky, Chris Hamilton, Chris Palmer, Daniel Vogelheim, Dominik Inführ, Hannes Payer, Joe Mason, Kentaro Hara, L. David Baron, Mathias Bynens, Matthew Bolohan, Michael Lippautz, Mike West, Neil Mckay, Olga Belomestnykh, Per Parker, Philipp Weis, and Yoav Weiss for their feedback and contributions.</p>
  </main>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-memorybreakdownentry-attribution">attribution</a><span>, in §2.1</span>
   <li><a href="#dom-memorymeasurement-breakdown">breakdown</a><span>, in §2.1</span>
   <li>
    bytes
    <ul>
     <li><a href="#intermediate-memory-breakdown-entry-bytes">dfn for intermediate memory breakdown entry</a><span>, in §2.2</span>
     <li><a href="#dom-memorybreakdownentry-bytes">dict-member for MemoryBreakdownEntry</a><span>, in §2.1</span>
     <li><a href="#dom-memorymeasurement-bytes">dict-member for MemoryMeasurement</a><span>, in §2.1</span>
    </ul>
   <li>
    container
    <ul>
     <li><a href="#memory-attribution-token-container">dfn for memory attribution token</a><span>, in §2.3</span>
     <li><a href="#dom-memoryattribution-container">dict-member for MemoryAttribution</a><span>, in §2.1</span>
    </ul>
   <li><a href="#creating-a-new-memory-attribution">create a new memory attribution</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-breakdown-entry">create a new memory breakdown entry</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-measurement">create a new memory measurement</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-attribution">creating a new memory attribution</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-breakdown-entry">creating a new memory breakdown entry</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-measurement">creating a new memory measurement</a><span>, in §3.3</span>
   <li><a href="#memory-attribution-token-cross-origin-aggregated-flag">cross-origin aggregated flag</a><span>, in §2.3</span>
   <li><a href="#extract-container-element-attributes">extract container element attributes</a><span>, in §3.4</span>
   <li><a href="#extract-container-element-attributes">extracting container element attributes</a><span>, in §3.4</span>
   <li><a href="#getting-all-agent-clusters">get all agent clusters</a><span>, in §3.2</span>
   <li><a href="#getting-all-agent-clusters">getting all agent clusters</a><span>, in §3.2</span>
   <li><a href="#dom-memoryattributioncontainer-id">id</a><span>, in §2.1</span>
   <li><a href="#implementation-defined-memory-measurement">implementation-defined memory measurement</a><span>, in §3.2</span>
   <li><a href="#intermediate-memory-breakdown-entry">intermediate memory breakdown entry</a><span>, in §2.2</span>
   <li><a href="#intermediate-memory-measurement">intermediate memory measurement</a><span>, in §2.2</span>
   <li><a href="#dom-performance-measureuseragentspecificmemory">measureUserAgentSpecificMemory()</a><span>, in §3.2</span>
   <li><a href="#dictdef-memoryattribution">MemoryAttribution</a><span>, in §2.1</span>
   <li><a href="#dictdef-memoryattributioncontainer">MemoryAttributionContainer</a><span>, in §2.1</span>
   <li>
    memory attribution token
    <ul>
     <li><a href="#memory-attribution-token">definition of</a><span>, in §2.3</span>
     <li><a href="#windoworworkerglobalscope-memory-attribution-token">dfn for WindowOrWorkerGlobalScope</a><span>, in §4.1</span>
    </ul>
   <li><a href="#dictdef-memorybreakdownentry">MemoryBreakdownEntry</a><span>, in §2.1</span>
   <li><a href="#dictdef-memorymeasurement">MemoryMeasurement</a><span>, in §2.1</span>
   <li><a href="#memory-measurement-allowed-predicate">memory measurement allowed predicate</a><span>, in §3.2</span>
   <li><a href="#obtain-a-window-memory-attribution-token">obtain a window memory attribution token</a><span>, in §3.4</span>
   <li><a href="#obtain-a-worker-memory-attribution-token">obtain a worker memory attribution token</a><span>, in §3.4</span>
   <li><a href="#obtain-a-window-memory-attribution-token">obtaining a window memory attribution token</a><span>, in §3.4</span>
   <li><a href="#obtain-a-worker-memory-attribution-token">obtaining a worker memory attribution token</a><span>, in §3.4</span>
   <li><a href="#intermediate-memory-breakdown-entry-realms">realms</a><span>, in §2.2</span>
   <li><a href="#dom-memoryattribution-scope">scope</a><span>, in §2.1</span>
   <li><a href="#dom-memoryattributioncontainer-src">src</a><span>, in §2.1</span>
   <li>
    types
    <ul>
     <li><a href="#intermediate-memory-breakdown-entry-types">dfn for intermediate memory breakdown entry</a><span>, in §2.2</span>
     <li><a href="#dom-memorybreakdownentry-types">dict-member for MemoryBreakdownEntry</a><span>, in §2.1</span>
    </ul>
   <li><a href="#dom-memoryattribution-url">url</a><span>, in §2.1</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-concept-element-local-name">
   <a href="https://dom.spec.whatwg.org/#concept-element-local-name">https://dom.spec.whatwg.org/#concept-element-local-name</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-element-local-name">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-agents">
   <a href="https://tc39.es/ecma262/#sec-agents">https://tc39.es/ecma262/#sec-agents</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-agents">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agents①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-agent-clusters">
   <a href="https://tc39.es/ecma262/#sec-agent-clusters">https://tc39.es/ecma262/#sec-agent-clusters</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-agent-clusters">2.2. Intermediate memory measurement</a> <a href="#ref-for-sec-agent-clusters①">(2)</a>
    <li><a href="#ref-for-sec-agent-clusters②">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agent-clusters③">(2)</a> <a href="#ref-for-sec-agent-clusters④">(3)</a> <a href="#ref-for-sec-agent-clusters⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-code-realms">
   <a href="https://tc39.es/ecma262/#sec-code-realms">https://tc39.es/ecma262/#sec-code-realms</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-code-realms">2.1. Memory measurement result</a> <a href="#ref-for-sec-code-realms①">(2)</a> <a href="#ref-for-sec-code-realms②">(3)</a> <a href="#ref-for-sec-code-realms③">(4)</a> <a href="#ref-for-sec-code-realms④">(5)</a>
    <li><a href="#ref-for-sec-code-realms⑤">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-sec-code-realms⑥">2.3. Memory attribution token</a> <a href="#ref-for-sec-code-realms⑦">(2)</a> <a href="#ref-for-sec-code-realms⑧">(3)</a>
    <li><a href="#ref-for-sec-code-realms⑨">3.2. Top-level algorithms</a> <a href="#ref-for-sec-code-realms①⓪">(2)</a>
    <li><a href="#ref-for-sec-code-realms①①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-sec-code-realms①②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-code-realms">
   <a href="https://tc39.es/ecma262/#sec-code-realms">https://tc39.es/ecma262/#sec-code-realms</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-code-realms">2.1. Memory measurement result</a> <a href="#ref-for-sec-code-realms①">(2)</a> <a href="#ref-for-sec-code-realms②">(3)</a> <a href="#ref-for-sec-code-realms③">(4)</a> <a href="#ref-for-sec-code-realms④">(5)</a>
    <li><a href="#ref-for-sec-code-realms⑤">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-sec-code-realms⑥">2.3. Memory attribution token</a> <a href="#ref-for-sec-code-realms⑦">(2)</a> <a href="#ref-for-sec-code-realms⑧">(3)</a>
    <li><a href="#ref-for-sec-code-realms⑨">3.2. Top-level algorithms</a> <a href="#ref-for-sec-code-realms①⓪">(2)</a>
    <li><a href="#ref-for-sec-code-realms①①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-sec-code-realms①②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-agent">
   <a href="https://tc39.es/ecma262/#sec-agent">https://tc39.es/ecma262/#sec-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-agent">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agent①">(2)</a> <a href="#ref-for-sec-agent②">(3)</a> <a href="#ref-for-sec-agent③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-performance">
   <a href="https://w3c.github.io/hr-time/#sec-performance">https://w3c.github.io/hr-time/#sec-performance</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-performance">3.1. Extensions to the Performance interface</a> <a href="#ref-for-sec-performance①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dedicatedworkerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dedicatedworkerglobalscope">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlelement">
   <a href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement">https://html.spec.whatwg.org/multipage/dom.html#htmlelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlelement">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-htmlelement①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sharedworkerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedworkerglobalscope">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-sharedworkerglobalscope①">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window">https://html.spec.whatwg.org/multipage/window-object.html#window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window">3.2. Top-level algorithms</a> <a href="#ref-for-window①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-windoworworkerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope">https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windoworworkerglobalscope">2.3. Memory attribution token</a>
    <li><a href="#ref-for-windoworworkerglobalscope①">4.1. Extension to WindowOrWorkerGlobalScope</a> <a href="#ref-for-windoworworkerglobalscope②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-workerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workerglobalscope">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window-bc">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window-bc">https://html.spec.whatwg.org/multipage/window-object.html#window-bc</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window-bc">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-browsing-context-group">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-context-group">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-creation-url">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-creation-url">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-cross-origin-isolated-capability">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability">2.1. Memory measurement result</a>
    <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability①">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability②">5.1. Cross-origin information leak</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-attr-object-data">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attr-object-data">2.1. Memory measurement result</a>
    <li><a href="#ref-for-attr-object-data①">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-settings-object">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-global">3.4. Creating or obtaining a memory attribution token</a>
    <li><a href="#ref-for-concept-settings-object-global①">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-in-parallel">
   <a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-object-element">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-object-element">2.1. Memory measurement result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-origin">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-navigator-platform">
   <a href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-platform">https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-platform</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigator-platform">5.2. Fingerprinting</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-global-task">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-global-task">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-concept-relevant-global①">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relevant-settings-object">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-realm-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-realm-settings-object">3.2. Top-level algorithms</a> <a href="#ref-for-concept-realm-settings-object①">(2)</a>
    <li><a href="#ref-for-concept-realm-settings-object②">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-attr-iframe-src">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attr-iframe-src">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-top-level-origin">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-navigator-useragent">
   <a href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent">https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigator-useragent">5.2. Fingerprinting</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-append">
   <a href="https://infra.spec.whatwg.org/#list-append">https://infra.spec.whatwg.org/#list-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-append">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-list-append①">(2)</a> <a href="#ref-for-list-append②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-assert">
   <a href="https://infra.spec.whatwg.org/#assert">https://infra.spec.whatwg.org/#assert</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assert">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-assert①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-assert②">(2)</a> <a href="#ref-for-assert③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-boolean">
   <a href="https://infra.spec.whatwg.org/#boolean">https://infra.spec.whatwg.org/#boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-boolean">2.3. Memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-iterate">
   <a href="https://infra.spec.whatwg.org/#list-iterate">https://infra.spec.whatwg.org/#list-iterate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-iterate">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-list-iterate①">(2)</a> <a href="#ref-for-list-iterate②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-getting-the-values">
   <a href="https://infra.spec.whatwg.org/#map-getting-the-values">https://infra.spec.whatwg.org/#map-getting-the-values</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-getting-the-values">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-implementation-defined">
   <a href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined">2.1. Memory measurement result</a>
    <li><a href="#ref-for-implementation-defined①">2.2. Intermediate memory measurement</a> <a href="#ref-for-implementation-defined②">(2)</a>
    <li><a href="#ref-for-implementation-defined③">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct-item">
   <a href="https://infra.spec.whatwg.org/#struct-item">https://infra.spec.whatwg.org/#struct-item</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct-item">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-struct-item①">2.3. Memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list">
   <a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-list①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
   <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-set">2.2. Intermediate memory measurement</a> <a href="#ref-for-ordered-set①">(2)</a> <a href="#ref-for-ordered-set②">(3)</a>
    <li><a href="#ref-for-ordered-set③">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string">
   <a href="https://infra.spec.whatwg.org/#string">https://infra.spec.whatwg.org/#string</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string">2.2. Intermediate memory measurement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct">
   <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-struct①">2.3. Memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-serviceworkerglobalscope">
   <a href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope">https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serviceworkerglobalscope">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-serviceworkerglobalscope①">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMException">
   <a href="https://heycam.github.io/webidl/#idl-DOMException">https://heycam.github.io/webidl/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
   <a href="https://heycam.github.io/webidl/#idl-DOMString">https://heycam.github.io/webidl/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">2.1. Memory measurement result</a> <a href="#ref-for-idl-DOMString①">(2)</a> <a href="#ref-for-idl-DOMString②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://heycam.github.io/webidl/#Exposed">https://heycam.github.io/webidl/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">3.1. Extensions to the Performance interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
   <a href="https://heycam.github.io/webidl/#idl-promise">https://heycam.github.io/webidl/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">1.1. Examples</a>
    <li><a href="#ref-for-idl-promise①">2.1. Memory measurement result</a>
    <li><a href="#ref-for-idl-promise②">3.1. Extensions to the Performance interface</a>
    <li><a href="#ref-for-idl-promise③">3.2. Top-level algorithms</a> <a href="#ref-for-idl-promise④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-securityerror">
   <a href="https://heycam.github.io/webidl/#securityerror">https://heycam.github.io/webidl/#securityerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-securityerror">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
   <a href="https://heycam.github.io/webidl/#idl-USVString">https://heycam.github.io/webidl/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">2.1. Memory measurement result</a> <a href="#ref-for-idl-USVString①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-rejected-with">
   <a href="https://heycam.github.io/webidl/#a-promise-rejected-with">https://heycam.github.io/webidl/#a-promise-rejected-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-rejected-with">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-identifier">
   <a href="https://heycam.github.io/webidl/#dfn-identifier">https://heycam.github.io/webidl/#dfn-identifier</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-identifier">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-interface">
   <a href="https://heycam.github.io/webidl/#dfn-interface">https://heycam.github.io/webidl/#dfn-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-interface">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-resolve">
   <a href="https://heycam.github.io/webidl/#resolve">https://heycam.github.io/webidl/#resolve</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-resolve">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-sequence">
   <a href="https://heycam.github.io/webidl/#idl-sequence">https://heycam.github.io/webidl/#idl-sequence</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-sequence">2.1. Memory measurement result</a> <a href="#ref-for-idl-sequence①">(2)</a> <a href="#ref-for-idl-sequence②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-unsigned-long-long">
   <a href="https://heycam.github.io/webidl/#idl-unsigned-long-long">https://heycam.github.io/webidl/#idl-unsigned-long-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unsigned-long-long">2.1. Memory measurement result</a> <a href="#ref-for-idl-unsigned-long-long①">(2)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-element-local-name">local name</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMASCRIPT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-sec-agents">agent</span>
     <li><span class="dfn-paneled" id="term-for-sec-agent-clusters">agent cluster <small>(for agent)</small></span>
     <li><span class="dfn-paneled" id="term-for-sec-code-realms">javascript realm</span>
     <li><span class="dfn-paneled" id="term-for-sec-code-realms①">javascript realms</span>
     <li><span class="dfn-paneled" id="term-for-sec-agent">the current realm</span>
    </ul>
   <li>
    <a data-link-type="biblio">[hr-time-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-sec-performance">Performance</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-htmlelement">HTMLElement</span>
     <li><span class="dfn-paneled" id="term-for-sharedworkerglobalscope">SharedWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-window">Window</span>
     <li><span class="dfn-paneled" id="term-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-workerglobalscope">WorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-window-bc">browsing context</span>
     <li><span class="dfn-paneled" id="term-for-browsing-context-group">browsing context group</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-creation-url">creation url</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-cross-origin-isolated-capability">cross-origin isolated capability</span>
     <li><span class="dfn-paneled" id="term-for-attr-object-data">data</span>
     <li><span class="dfn-paneled" id="term-for-environment-settings-object">environment settings object</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-global">global object <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="term-for-in-parallel">in parallel</span>
     <li><span class="dfn-paneled" id="term-for-the-object-element">object</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-origin">origin <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="term-for-dom-navigator-platform">platform</span>
     <li><span class="dfn-paneled" id="term-for-queue-a-global-task">queue a global task</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
     <li><span class="dfn-paneled" id="term-for-relevant-settings-object">relevant settings object</span>
     <li><span class="dfn-paneled" id="term-for-concept-realm-settings-object">settings object</span>
     <li><span class="dfn-paneled" id="term-for-attr-iframe-src">src</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-origin">top-level origin</span>
     <li><span class="dfn-paneled" id="term-for-dom-navigator-useragent">userAgent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-list-append">append</span>
     <li><span class="dfn-paneled" id="term-for-assert">assert</span>
     <li><span class="dfn-paneled" id="term-for-boolean">boolean</span>
     <li><span class="dfn-paneled" id="term-for-list-iterate">for each</span>
     <li><span class="dfn-paneled" id="term-for-map-getting-the-values">getting the values</span>
     <li><span class="dfn-paneled" id="term-for-implementation-defined">implementation-defined</span>
     <li><span class="dfn-paneled" id="term-for-struct-item">item</span>
     <li><span class="dfn-paneled" id="term-for-list">list</span>
     <li><span class="dfn-paneled" id="term-for-ordered-set">set</span>
     <li><span class="dfn-paneled" id="term-for-string">string</span>
     <li><span class="dfn-paneled" id="term-for-struct">struct</span>
    </ul>
   <li>
    <a data-link-type="biblio">[service-workers-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-serviceworkerglobalscope">ServiceWorkerGlobalScope</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-DOMException">DOMException</span>
     <li><span class="dfn-paneled" id="term-for-idl-DOMString">DOMString</span>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
     <li><span class="dfn-paneled" id="term-for-securityerror">SecurityError</span>
     <li><span class="dfn-paneled" id="term-for-idl-USVString">USVString</span>
     <li><span class="dfn-paneled" id="term-for-a-promise-rejected-with">a promise rejected with</span>
     <li><span class="dfn-paneled" id="term-for-dfn-identifier">identifier</span>
     <li><span class="dfn-paneled" id="term-for-dfn-interface">interface</span>
     <li><span class="dfn-paneled" id="term-for-resolve">resolve</span>
     <li><span class="dfn-paneled" id="term-for-idl-sequence">sequence</span>
     <li><span class="dfn-paneled" id="term-for-idl-unsigned-long-long">unsigned long long</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-ecmascript">[ECMASCRIPT]
   <dd><a href="https://tc39.es/ecma262/">ECMAScript Language Specification</a>. URL: <a href="https://tc39.es/ecma262/">https://tc39.es/ecma262/</a>
   <dt id="biblio-hr-time-2">[HR-TIME-2]
   <dd>Ilya Grigorik. <a href="https://w3c.github.io/hr-time/">High Resolution Time Level 2</a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-service-workers-1">[SERVICE-WORKERS-1]
   <dd>Alex Russell; et al. <a href="https://w3c.github.io/ServiceWorker/">Service Workers 1</a>. URL: <a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Boris Zbarsky. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>dictionary</c-> <a href="#dictdef-memorymeasurement"><code><c- g>MemoryMeasurement</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long " href="#dom-memorymeasurement-bytes"><code><c- g>bytes</c-></code></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorybreakdownentry"><c- n>MemoryBreakdownEntry</c-></a>> <a data-type="sequence<MemoryBreakdownEntry> " href="#dom-memorymeasurement-breakdown"><code><c- g>breakdown</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memorybreakdownentry"><code><c- g>MemoryBreakdownEntry</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long " href="#dom-memorybreakdownentry-bytes"><code><c- g>bytes</c-></code></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memoryattribution"><c- n>MemoryAttribution</c-></a>> <a data-type="sequence<MemoryAttribution> " href="#dom-memorybreakdownentry-attribution"><code><c- g>attribution</c-></code></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a>> <a data-type="sequence<DOMString> " href="#dom-memorybreakdownentry-types"><code><c- g>types</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memoryattribution"><code><c- g>MemoryAttribution</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-memoryattribution-url"><code><c- g>url</c-></code></a>;
  <a data-link-type="idl-name" href="#dictdef-memoryattributioncontainer"><c- n>MemoryAttributionContainer</c-></a> <a data-type="MemoryAttributionContainer " href="#dom-memoryattribution-container"><code><c- g>container</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-memoryattribution-scope"><code><c- g>scope</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memoryattributioncontainer"><code><c- g>MemoryAttributionContainer</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-memoryattributioncontainer-id"><code><c- g>id</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-memoryattributioncontainer-src"><code><c- g>src</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/hr-time/#sec-performance"><c- g>Performance</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>ServiceWorker</c->,<c- n>SharedWorker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://github.com/heycam/webidl#pull/883"><c- g>CrossOriginIsolated</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorymeasurement"><c- n>MemoryMeasurement</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-performance-measureuseragentspecificmemory"><c- g>measureUserAgentSpecificMemory</c-></a>();
};

</pre>
  <aside class="dfn-panel" data-for="dictdef-memorymeasurement">
   <b><a href="#dictdef-memorymeasurement">#dictdef-memorymeasurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memorymeasurement">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memorymeasurement①">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-dictdef-memorymeasurement②">3.1. Extensions to the Performance interface</a>
    <li><a href="#ref-for-dictdef-memorymeasurement③">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorymeasurement-bytes">
   <b><a href="#dom-memorymeasurement-bytes">#dom-memorymeasurement-bytes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorymeasurement-bytes">2.1. Memory measurement result</a> <a href="#ref-for-dom-memorymeasurement-bytes①">(2)</a>
    <li><a href="#ref-for-dom-memorymeasurement-bytes②">3.3. Converting an intermediate memory measurement to the result</a>
    <li><a href="#ref-for-dom-memorymeasurement-bytes③">5.1. Cross-origin information leak</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorymeasurement-breakdown">
   <b><a href="#dom-memorymeasurement-breakdown">#dom-memorymeasurement-breakdown</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorymeasurement-breakdown">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorymeasurement-breakdown①">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-memorybreakdownentry">
   <b><a href="#dictdef-memorybreakdownentry">#dictdef-memorybreakdownentry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memorybreakdownentry">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memorybreakdownentry①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dictdef-memorybreakdownentry②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorybreakdownentry-bytes">
   <b><a href="#dom-memorybreakdownentry-bytes">#dom-memorybreakdownentry-bytes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorybreakdownentry-bytes">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorybreakdownentry-bytes①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memorybreakdownentry-bytes②">(2)</a>
    <li><a href="#ref-for-dom-memorybreakdownentry-bytes③">5.1. Cross-origin information leak</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorybreakdownentry-attribution">
   <b><a href="#dom-memorybreakdownentry-attribution">#dom-memorybreakdownentry-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorybreakdownentry-attribution">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorybreakdownentry-attribution①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memorybreakdownentry-attribution②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorybreakdownentry-types">
   <b><a href="#dom-memorybreakdownentry-types">#dom-memorybreakdownentry-types</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorybreakdownentry-types">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorybreakdownentry-types①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memorybreakdownentry-types②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-memoryattribution">
   <b><a href="#dictdef-memoryattribution">#dictdef-memoryattribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memoryattribution">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memoryattribution①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dictdef-memoryattribution②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattribution-url">
   <b><a href="#dom-memoryattribution-url">#dom-memoryattribution-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattribution-url">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattribution-url①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memoryattribution-url②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattribution-container">
   <b><a href="#dom-memoryattribution-container">#dom-memoryattribution-container</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattribution-container">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattribution-container①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memoryattribution-container②">(2)</a> <a href="#ref-for-dom-memoryattribution-container③">(3)</a> <a href="#ref-for-dom-memoryattribution-container④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattribution-scope">
   <b><a href="#dom-memoryattribution-scope">#dom-memoryattribution-scope</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattribution-scope">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattribution-scope①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memoryattribution-scope②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-memoryattributioncontainer">
   <b><a href="#dictdef-memoryattributioncontainer">#dictdef-memoryattributioncontainer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memoryattributioncontainer">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memoryattributioncontainer①">2.3. Memory attribution token</a>
    <li><a href="#ref-for-dictdef-memoryattributioncontainer②">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-dictdef-memoryattributioncontainer③">(2)</a> <a href="#ref-for-dictdef-memoryattributioncontainer④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattributioncontainer-id">
   <b><a href="#dom-memoryattributioncontainer-id">#dom-memoryattributioncontainer-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattributioncontainer-id">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattributioncontainer-id①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-dom-memoryattributioncontainer-id②">(2)</a> <a href="#ref-for-dom-memoryattributioncontainer-id③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattributioncontainer-src">
   <b><a href="#dom-memoryattributioncontainer-src">#dom-memoryattributioncontainer-src</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattributioncontainer-src">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattributioncontainer-src①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-dom-memoryattributioncontainer-src②">(2)</a> <a href="#ref-for-dom-memoryattributioncontainer-src③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-measurement">
   <b><a href="#intermediate-memory-measurement">#intermediate-memory-measurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-measurement">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-intermediate-memory-measurement①">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-intermediate-memory-measurement②">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry">
   <b><a href="#intermediate-memory-breakdown-entry">#intermediate-memory-breakdown-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry">2.2. Intermediate memory measurement</a> <a href="#ref-for-intermediate-memory-breakdown-entry①">(2)</a>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry②">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-intermediate-memory-breakdown-entry③">(2)</a> <a href="#ref-for-intermediate-memory-breakdown-entry④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-bytes">
   <b><a href="#intermediate-memory-breakdown-entry-bytes">#intermediate-memory-breakdown-entry-bytes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry-bytes">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-intermediate-memory-breakdown-entry-bytes①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-realms">
   <b><a href="#intermediate-memory-breakdown-entry-realms">#intermediate-memory-breakdown-entry-realms</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry-realms">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-types">
   <b><a href="#intermediate-memory-breakdown-entry-types">#intermediate-memory-breakdown-entry-types</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry-types">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-attribution-token">
   <b><a href="#memory-attribution-token">#memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-attribution-token">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-memory-attribution-token①">(2)</a> <a href="#ref-for-memory-attribution-token②">(3)</a> <a href="#ref-for-memory-attribution-token③">(4)</a> <a href="#ref-for-memory-attribution-token④">(5)</a>
    <li><a href="#ref-for-memory-attribution-token⑤">4.1. Extension to WindowOrWorkerGlobalScope</a>
    <li><a href="#ref-for-memory-attribution-token⑥">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-attribution-token-container">
   <b><a href="#memory-attribution-token-container">#memory-attribution-token-container</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-attribution-token-container">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-memory-attribution-token-container①">(2)</a>
    <li><a href="#ref-for-memory-attribution-token-container②">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-memory-attribution-token-container③">(2)</a> <a href="#ref-for-memory-attribution-token-container④">(3)</a> <a href="#ref-for-memory-attribution-token-container⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-attribution-token-cross-origin-aggregated-flag">
   <b><a href="#memory-attribution-token-cross-origin-aggregated-flag">#memory-attribution-token-cross-origin-aggregated-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag">3.3. Converting an intermediate memory measurement to the result</a>
    <li><a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag②">(2)</a> <a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag③">(3)</a> <a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-performance-measureuseragentspecificmemory">
   <b><a href="#dom-performance-measureuseragentspecificmemory">#dom-performance-measureuseragentspecificmemory</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory">1. Introduction</a>
    <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory①">1.1. Examples</a> <a href="#ref-for-dom-performance-measureuseragentspecificmemory②">(2)</a>
    <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory③">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory④">3.1. Extensions to the Performance interface</a> <a href="#ref-for-dom-performance-measureuseragentspecificmemory⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-measurement-allowed-predicate">
   <b><a href="#memory-measurement-allowed-predicate">#memory-measurement-allowed-predicate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-measurement-allowed-predicate">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="getting-all-agent-clusters">
   <b><a href="#getting-all-agent-clusters">#getting-all-agent-clusters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-getting-all-agent-clusters">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="implementation-defined-memory-measurement">
   <b><a href="#implementation-defined-memory-measurement">#implementation-defined-memory-measurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined-memory-measurement">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="creating-a-new-memory-measurement">
   <b><a href="#creating-a-new-memory-measurement">#creating-a-new-memory-measurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-creating-a-new-memory-measurement">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="creating-a-new-memory-breakdown-entry">
   <b><a href="#creating-a-new-memory-breakdown-entry">#creating-a-new-memory-breakdown-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-creating-a-new-memory-breakdown-entry">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="creating-a-new-memory-attribution">
   <b><a href="#creating-a-new-memory-attribution">#creating-a-new-memory-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-creating-a-new-memory-attribution">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-window-memory-attribution-token">
   <b><a href="#obtain-a-window-memory-attribution-token">#obtain-a-window-memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-window-memory-attribution-token">4.2. Extensions to the existing algorithms</a> <a href="#ref-for-obtain-a-window-memory-attribution-token①">(2)</a> <a href="#ref-for-obtain-a-window-memory-attribution-token②">(3)</a> <a href="#ref-for-obtain-a-window-memory-attribution-token③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-worker-memory-attribution-token">
   <b><a href="#obtain-a-worker-memory-attribution-token">#obtain-a-worker-memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-worker-memory-attribution-token">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="extract-container-element-attributes">
   <b><a href="#extract-container-element-attributes">#extract-container-element-attributes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-extract-container-element-attributes">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windoworworkerglobalscope-memory-attribution-token">
   <b><a href="#windoworworkerglobalscope-memory-attribution-token">#windoworworkerglobalscope-memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token">3.3. Converting an intermediate memory measurement to the result</a>
    <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token①">3.4. Creating or obtaining a memory attribution token</a>
    <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token②">4.2. Extensions to the existing algorithms</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token③">(2)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token④">(3)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑤">(4)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑥">(5)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑦">(6)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑧">(7)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑨">(8)</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    {
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>