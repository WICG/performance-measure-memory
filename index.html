<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Measure Memory API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover {
			background: rgba(75%, 75%, 75%, .25);
			border-bottom: 3px solid #054572;
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good table positioning:
		   "content column" is 50ems wide at max; less on smaller screens.
		   Extra space (after ToC + content) is empty on the right.

		   1. When table < content column, centers table in column.
		   2. When content < table < available, left-aligns.
		   3. When table > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <link href="https://www.w3.org/StyleSheets/TR/2016/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 40de15f9, updated Thu Jun 11 17:47:04 2020 -0700" name="generator">
  <link href="https://wicg.github.io/performance-measure-memory/" rel="canonical">
  <meta content="2dc2c55e1d74299b9cb23ab4dd29169df0de7a2d" name="document-revision">
<style>
/* domintro from https://resources.whatwg.org/standard.css */
.domintro {
  position: relative;
  color: green;
  background: #DDFFDD;
  margin: 2.5em 0 2em 0;
  padding: 1.5em 1em 0.5em 2em;
}

.domintro dt, .domintro dt * {
  color: black;
  font-size: inherit;
}
.domintro dd {
  margin: 0.5em 0 1em 2em; padding: 0;
}
.domintro dd p {
  margin: 0.5em 0;
}
.domintro::before {
  content: 'For web developers (non-normative)';
  background: green;
  color: white;
  padding: 0.15em 0.25em;
  font-style: normal;
  position: absolute;
  top: -0.8em;
  left: -0.8em;
}
</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: #DDDDDD;
    color: black;
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: black; }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Measure Memory API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="2020-10-20">20 October 2020</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/performance-measure-memory/">https://wicg.github.io/performance-measure-memory/</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:ulan@google.com">Ulan Degenbaev</a> (<a class="p-org org" href="https://www.google.com/">Google</a>)
     <dt>Participate:
     <dd><a href="https://github.com/WICG/performance-measure-memory">GitHub WICG/performance-measure-memory</a> (<a href="https://github.com/WICG/performance-measure-memory/issues/new">new issue</a>, <a href="https://github.com/WICG/performance-measure-memory/issues?state=open">open issues</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2020 the Contributors to the Measure Memory API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines an API that allows web applications to measure their memory usage.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#data-model"><span class="secno">2</span> <span class="content">Data model</span></a>
     <ol class="toc">
      <li><a href="#memory-measurement-result"><span class="secno">2.1</span> <span class="content">Memory measurement result</span></a>
      <li><a href="#intermediate-memory-measurement-section"><span class="secno">2.2</span> <span class="content">Intermediate memory measurement</span></a>
      <li><a href="#memory-attribution-token-section"><span class="secno">2.3</span> <span class="content">Memory attribution token</span></a>
     </ol>
    <li>
     <a href="#processing-model"><span class="secno">3</span> <span class="content">Processing model</span></a>
     <ol class="toc">
      <li><a href="#extensions-to-performance"><span class="secno">3.1</span> <span class="content">Extensions to the <code class="idl"><span>Performance</span></code> interface</span></a>
      <li><a href="#top-level-algorithms"><span class="secno">3.2</span> <span class="content">Top-level algorithms</span></a>
      <li><a href="#converting-an-intermediate-memory-measurement-to-the-result"><span class="secno">3.3</span> <span class="content">Converting an intermediate memory measurement to the result</span></a>
      <li><a href="#creating-or-obtaining-a-memory-attribution-token"><span class="secno">3.4</span> <span class="content">Creating or obtaining a memory attribution token</span></a>
     </ol>
    <li>
     <a href="#integration-with-the-existing-specification"><span class="secno">4</span> <span class="content">Integration with the existing specification</span></a>
     <ol class="toc">
      <li><a href="#extension-to-window-or-worker-global-scope"><span class="secno">4.1</span> <span class="content">Extension to <code class="idl"><span>WindowOrWorkerGlobalScope</span></code></span></a>
      <li><a href="#extensions-to-the-existing-algorithms"><span class="secno">4.2</span> <span class="content">Extensions to the existing algorithms</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">5</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <div nonnormative>
     The tradeoff between memory and performance is inherent in many algorithms and data-structures.
Web developers today have multiple ways to measure the timing information and no standard way to measure the memory usage.
This specification defines a <code class="idl"><a data-link-type="idl" href="#dom-performance-measurememory" id="ref-for-dom-performance-measurememory">performance.measureMemory()</a></code> API that estimates the memory usage of the web application including all its iframes and workers.
The new API is intended for aggregating memory usage data from production. The main use cases are: 
    <ul>
     <li data-md>
      <p>Regression detection during rollout of a new version of the web application to catch new memory leaks.</p>
     <li data-md>
      <p>A/B testing a new feature to evaluate its memory impact.</p>
     <li data-md>
      <p>Correlating memory usage with user metrics to understand the overall impact of memory usage. </p>
    </ul>
   </div>
   <p></p>
   <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
   <div class="example" id="example-simple-page">
    <a class="self-link" href="#example-simple-page"></a> 
    <p>A <code class="idl"><a data-link-type="idl" href="#dom-performance-measurememory" id="ref-for-dom-performance-measurememory①">performance.measureMemory()</a></code> call returns a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise">Promise</a></code> and starts
an asynchronous measurement of the memory allocated by the page.</p>
<pre class="language-javascript highlight">async <c- a>function</c-> run<c- p>()</c-> <c- p>{</c->
  <c- kr>const</c-> result <c- o>=</c-> await performance<c- p>.</c->measureMemory<c- p>();</c->
  console<c- p>.</c->log<c- p>(</c->result<c- p>);</c->
<c- p>}</c->
run<c- p>();</c->
</pre>
    <p>For a simple page without iframes and workers the result might look as follows:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Here all memory is attributed to the main page. 
    <p>Other possible valid results:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[],</c->
<c- p>}</c->
</pre>
    Here the implementation provides only the total memory usage. 
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Here the implementation does not break memory down by memory types. 
   </div>
   <div class="example" id="example-same-origin-iframe">
    <a class="self-link" href="#example-same-origin-iframe"></a> 
    <p>For a page that embeds a same-origin iframe the result might attribute some memory
to that iframe and provide diagnostic information for identifying the iframe:</p>
<pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"redirect.html?target=iframe.html"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1500000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe.html"</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"redirect.html?target=iframe.html"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>}</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Note how the <code>url</code> and <code>container.src</code> fields differ for the iframe.
The former reflects the current <code>location.href</code> of the iframe whereas the
latter is the value of the <code>src</code> attribute of the iframe element. 
    <p>It is not always possible to separate iframe memory from page memory in a
meaningful way.
An implementation is allowed to lump together some or all of iframe and page memory:</p>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1500000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe.html"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"redirect.html?target=iframe.html"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>};</c->
</pre>
   </div>
   <div class="example" id="example-web-worker">
    <a class="self-link" href="#example-web-worker"></a> For a page that spawns a web worker the result includes the URL of the worker. 
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1800000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>800000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/worker.js"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"DedicatedWorkerGlobalScope"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>};</c->
</pre>
    An implementation might lump together worker and page memory. If a worker is
spawned by an iframe, then the worker’s attribution entry has a <code>container</code> field
corresponding to the iframe element. 
    <p>Memory of shared and service workers is not included in the result.</p>
   </div>
   <div class="example" id="example-shared-worker">
    <a class="self-link" href="#example-shared-worker"></a> To get the memory usage of a shared/service worker, the <code class="idl"><a data-link-type="idl" href="#dom-performance-measurememory" id="ref-for-dom-performance-measurememory②">performance.measureMemory()</a></code> function needs to be invoked in the context of that worker.
The result could be something like: 
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/service-worker.js"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"ServiceWorkerGlobalScope"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
   </div>
   <div class="example" id="example-cross-origin-iframe">
    <a class="self-link" href="#example-cross-origin-iframe"></a> If a page embeds a cross-origin iframe, then the URL of that iframe is not
revealed to avoid information leaks. Only the container element
(which is already known to the page) appears in the result.
Additionally, if the cross-origin iframe embeds other cross-origin iframes
and/or spawns workers, then all their memory is aggregated and attributed to
the top-most cross-origin iframe. 
    <p>Consider a page with the following structure:</p>
<pre class="language-javascript highlight">example<c- p>.</c->com <c- p>(</c-><c- mi>1000000</c-> bytes<c- p>)</c->
  <c- o>|</c->
  <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe1 <c- p>(</c-><c- mi>500000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mi>200000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->bar<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mi>300000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->worker<c- p>.</c->js <c- p>(</c-><c- mi>400000</c-> bytes<c- p>)</c->
</pre>
    A cross-origin iframe embeds to other iframes and spawns a worker.
All memory of these resources is attributed to the first iframe. 
<pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://foo.com/iframe1"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>2400000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1400000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
    Note that the <code>url</code> and <code>scope</code> fields of the cross-origin iframe entry have
special values indicating that information is not available. 
   </div>
   <div class="example" id="example-same-and-cross-origin-iframes">
    <a class="self-link" href="#example-same-and-cross-origin-iframes"></a> If a cross-origin iframe embeds an iframe of the same origin as the main page,
then the same-origin iframe is revealed in the result.
Note that there is no information leak because the main page can find and read <code>location.href</code> of the same-origin iframe. 
<pre class="language-javascript highlight">example<c- p>.</c->com <c- p>(</c-><c- mi>1000000</c-> bytes<c- p>)</c->
  <c- o>|</c->
  <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe1 <c- p>(</c-><c- mi>500000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->example<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mi>200000</c-> bytes<c- p>)</c->
</pre>
<pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://foo.com/iframe1"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
<pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mi>1700000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mi>200000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe2"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      userAgentSpecificTypes<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
   </div>
   <h2 class="heading settled" data-level="2" id="data-model"><span class="secno">2. </span><span class="content">Data model</span><a class="self-link" href="#data-model"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="memory-measurement-result"><span class="secno">2.1. </span><span class="content">Memory measurement result</span><a class="self-link" href="#memory-measurement-result"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-performance-measurememory" id="ref-for-dom-performance-measurememory③">performance.measureMemory()</a></code> function returns a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①">Promise</a></code> that resolves to an instance of <code class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement">MemoryMeasurement</a></code> dictionary:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memorymeasurement"><code><c- g>MemoryMeasurement</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryMeasurement" data-dfn-type="dict-member" data-export data-type="unsigned long long " id="dom-memorymeasurement-bytes"><code><c- g>bytes</c-></code></dfn>;
  <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry"><c- n>MemoryBreakdownEntry</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryMeasurement" data-dfn-type="dict-member" data-export data-type="sequence<MemoryBreakdownEntry> " id="dom-memorymeasurement-breakdown"><code><c- g>breakdown</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>measurement . <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes">bytes</a></code></code>
     <dd data-md>
      <p>A number that represents the total memory usage.</p>
     <dt data-md><code>measurement . <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-breakdown" id="ref-for-dom-memorymeasurement-breakdown">breakdown</a></code></code>
     <dd data-md>
      <p>An array that partitions the total <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes①">bytes</a></code> and provides attribution and type information. </p>
    </dl>
    <p></p>
   </dl>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memorybreakdownentry"><code><c- g>MemoryBreakdownEntry</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long①"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="unsigned long long " id="dom-memorybreakdownentry-bytes"><code><c- g>bytes</c-></code></dfn>;
  <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution"><c- n>MemoryAttribution</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="sequence<MemoryAttribution> " id="dom-memorybreakdownentry-attribution"><code><c- g>attribution</c-></code></dfn>;
  <c- b>sequence</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="sequence<DOMString> " id="dom-memorybreakdownentry-useragentspecifictypes"><code><c- g>userAgentSpecificTypes</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes">bytes</a></code></code>
     <dd data-md>
      <p>The size of the memory that this entry describes.</p>
     <dt data-md><code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution">attribution</a></code></code>
     <dd data-md>
      <p>An array of URLs and/or container elements of the <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms">JavaScript realms</a> that use the memory.</p>
     <dt data-md><code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-useragentspecifictypes" id="ref-for-dom-memorybreakdownentry-useragentspecifictypes">userAgentSpecificTypes</a></code></code>
     <dd data-md>
      <p>An array of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> memory types associated with the memory. </p>
    </dl>
    <p></p>
   </dl>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memoryattribution"><code><c- g>MemoryAttribution</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-memoryattribution-url"><code><c- g>url</c-></code></dfn>;
  <a class="n" data-link-type="idl-name" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer"><c- n>MemoryAttributionContainer</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="MemoryAttributionContainer " id="dom-memoryattribution-container"><code><c- g>container</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-memoryattribution-scope"><code><c- g>scope</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url">url</a></code></code>
     <dd data-md>
      <p>If this attribution corresponds to a same-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①">JavaScript realm</a>, then this field contains realm’s URL.
 Otherwise, the attribution is for one or more cross-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms②">JavaScript realms</a> and this field contains
 a sentinel value: <code>"cross-origin-url"</code>.</p>
     <dt data-md><code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container">container</a></code></code>
     <dd data-md>
      <p>Describes the DOM element that (maybe indirectly) contains the <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms③">JavaScript realms</a>.
 This property might be absent if the attribution is for the same-origin top-level realm.
 Note that cross-origin realms cannot be top-level due to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#cross-origin-isolated" id="ref-for-cross-origin-isolated">cross-origin isolation</a>.</p>
     <dt data-md><code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope">scope</a></code></code>
     <dd data-md>
      <p>Describes the type of the same-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms④">JavaScript realm</a>: <code>"Window", "DedicatedWorkerGlobalScope", "SharedWorkerGlobalScope", "ServiceWorkerGlobalScope"</code> or <code>"cross-origin-aggregated"</code> for the cross-origin case. </p>
    </dl>
    <p></p>
   </dl>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memoryattributioncontainer"><code><c- g>MemoryAttributionContainer</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttributionContainer" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-memoryattributioncontainer-id"><code><c- g>id</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttributionContainer" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-memoryattributioncontainer-src"><code><c- g>src</c-></code></dfn>;
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>container . <code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id">id</a></code></code>
     <dd data-md>
      <p>The <code>id</code> attribute of the container element.</p>
     <dt data-md><code>container . <code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src">src</a></code></code>
     <dd data-md>
      <p>The <code>src</code> attribute of the container element. If the container element is an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element">object</a></code> element,
 then this field contains the value of the <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data">data</a></code> attribute.</p>
    </dl>
    <p></p>
   </dl>
   <h3 class="heading settled" data-level="2.2" id="intermediate-memory-measurement-section"><span class="secno">2.2. </span><span class="content">Intermediate memory measurement</span><a class="self-link" href="#intermediate-memory-measurement-section"></a></h3>
   <p>This specification assumes the existences of an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①">implementation-defined</a> algorithm that can measure
the memory of objects allocated by a set of <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters">JavaScript agent clusters</a>.
The result of such algorithm is an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="intermediate-memory-measurement">intermediate memory measurement</dfn>,
which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">set</a> of <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry">intermediate memory breakdown entries</a>.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry">intermediate memory breakdown entry</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> containing the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry-bytes">bytes</dfn>
    <dd data-md>
     <p>The size of the memory that this <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry①">intermediate memory breakdown entry</a> describes.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry-realms">realms</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">set</a> of <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑤">JavaScript realms</a> to which the memory is attributed to.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn" data-noexport id="intermediate-memory-breakdown-entry-user-agent-specific-types">user agent specific types</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">set</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">strings</a> specifying <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined②">implementation-defined</a> memory types associated with the memory.</p>
   </dl>
   <p>Algorithms defined in this specification show how to convert an <a data-link-type="dfn" href="#intermediate-memory-measurement" id="ref-for-intermediate-memory-measurement">intermediate memory measurement</a> to an instance of <code class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement①">MemoryMeasurement</a></code>.</p>
   <h3 class="heading settled" data-level="2.3" id="memory-attribution-token-section"><span class="secno">2.3. </span><span class="content">Memory attribution token</span><a class="self-link" href="#memory-attribution-token-section"></a></h3>
   <p>The link between an embedded <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑥">JavaScript realm</a> and its container element is ephemeral and is not guaranteed to always exist.
For example, navigation to another document in the container element or removal of the container element from the DOM tree severs the link.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="memory-attribution-token">memory attribution token</dfn> provides a way to get from a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑦">JavaScript realm</a> to its container element.
It is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> containing the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item①">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="memory attribution token" data-dfn-type="dfn" data-noexport id="memory-attribution-token-container">container</dfn>
    <dd data-md>
     <p>An instance of <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer①">MemoryAttributionContainer</a></code>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="memory attribution token" data-dfn-type="dfn" data-noexport id="memory-attribution-token-cross-origin-aggregated-flag">cross-origin aggregated flag</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean">boolean</a> flag indicating whether the token was created for aggregating the memory usage of
 cross-origin <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑧">JavaScript realms</a>.</p>
   </dl>
   <p>It is stored in a new internal field of <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> at construction time and is always available for memory reporting.</p>
   <h2 class="heading settled" data-level="3" id="processing-model"><span class="secno">3. </span><span class="content">Processing model</span><a class="self-link" href="#processing-model"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="extensions-to-performance"><span class="secno">3.1. </span><span class="content">Extensions to the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#sec-performance" id="ref-for-sec-performance">Performance</a></code> interface</span><a class="self-link" href="#extensions-to-performance"></a></h3>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/hr-time/#sec-performance" id="ref-for-sec-performance①"><c- g>Performance</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://github.com/heycam/webidl#pull/883" id="ref-for-pull/883"><c- g>CrossOriginIsolated</c-></a>] <c- b>Promise</c->&lt;<a class="n" data-link-type="idl-name" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement②"><c- n>MemoryMeasurement</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-performance-measurememory" id="ref-for-dom-performance-measurememory④"><c- g>measureMemory</c-></a>();
};
</pre>
   <dl class="domintro">
    <dl>
     <dt data-md><code>performance . <code class="idl"><a data-link-type="idl" href="#dom-performance-measurememory" id="ref-for-dom-performance-measurememory⑤">measureMemory()</a></code></code>
     <dd data-md>
      <p>A method that performs an asynchronous memory measurement. Details about the result of the method are in <a href="#memory-measurement-result">§ 2.1 Memory measurement result</a>. </p>
    </dl>
    <p></p>
   </dl>
   <h3 class="heading settled" data-level="3.2" id="top-level-algorithms"><span class="secno">3.2. </span><span class="content">Top-level algorithms</span><a class="self-link" href="#top-level-algorithms"></a></h3>
   <div class="algorithm" data-algorithm="measureMemory()" data-algorithm-for="Performance">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="Performance" data-dfn-type="method" data-export id="dom-performance-measurememory"><code>measureMemory()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent">the current Realm</a>'s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agents" id="ref-for-sec-agents">agent</a>'s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters①">agent cluster</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#cross-origin-isolated" id="ref-for-cross-origin-isolated①">cross-origin isolated</a> is true.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="#memory-measurement-allowed-predicate" id="ref-for-memory-measurement-allowed-predicate">memory measurement allowed predicate</a> given <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent①">the current Realm</a> is false, then:</p>
      <ol>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with">a promise rejected with</a> a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror" id="ref-for-securityerror">SecurityError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>.</p>
      </ol>
     <li data-md>
      <p>Let <var>agent clusters</var> be the result of <a data-link-type="dfn" href="#getting-all-agent-clusters" id="ref-for-getting-all-agent-clusters">getting all agent clusters</a> given <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent②">the current Realm</a>.</p>
     <li data-md>
      <p>Let <var>promise</var> be a new <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise②">Promise</a></code>.</p>
     <li data-md>
      <p>Start asynchronous <a data-link-type="dfn" href="#implementation-defined-memory-measurement" id="ref-for-implementation-defined-memory-measurement">implementation-defined memory measurement</a> given <var>agent clusters</var> and <var>promise</var>.</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="memory measurement allowed predicate">
     To evaluate <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="memory-measurement-allowed-predicate">memory measurement allowed predicate</dfn> given a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑨">JavaScript realm</a> <var>realm</var>: 
    <ol>
     <li data-md>
      <p>Let <var>global object</var> be <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global">global object</a>.</p>
     <li data-md>
      <p>If <var>global object</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope">SharedWorkerGlobalScope</a></code>, then return true.</p>
     <li data-md>
      <p>If <var>global object</var> is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope">ServiceWorkerGlobalScope</a></code>, then return true.</p>
     <li data-md>
      <p>If <var>global object</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window">Window</a></code> then</p>
      <ol>
       <li data-md>
        <p>Let <var>settings object</var> be <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object">settings object</a>.</p>
       <li data-md>
        <p>If <var>settings object</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin">origin</a> is the same as <var>settings object</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-origin">top-level origin</a>, then return true.</p>
      </ol>
     <li data-md>
      <p>Return false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="getting all agent clusters">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="getting all agent clusters|get all agent clusters" data-noexport id="getting-all-agent-clusters">get all agent clusters</dfn> given an <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①⓪">JavaScript realm</a> <var>realm</var>: 
    <ol>
     <li data-md>
      <p>If <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global①">global object</a> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window①">Window</a></code>, then:</p>
      <ol>
       <li data-md>
        <p>Let <var>group</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group" id="ref-for-browsing-context-group">browsing context group</a> that contains <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global②">global object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#window-bc" id="ref-for-window-bc">browsing context</a>.</p>
       <li data-md>
        <p>Return the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-values" id="ref-for-map-getting-the-values">getting the values</a> of <var>group</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#agent-cluster-map" id="ref-for-agent-cluster-map">agent cluster map</a>.</p>
      </ol>
     <li data-md>
      <p>Return « <var>realm</var>’s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agents" id="ref-for-sec-agents①">agent</a>'s <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters②">agent cluster</a> ».</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="implementation-defined memory measurement">
     To perform <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="implementation-defined-memory-measurement">implementation-defined memory measurement</dfn> given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set③">set</a> of <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters③">agent clusters</a> <var>agent clusters</var> and
  a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise③">Promise</a></code> <var>promise</var> run these steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>: 
    <ol>
     <li data-md>
      <p>Let <var>intermediate memory measurement</var> be an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined③">implementation-defined</a> <a data-link-type="dfn" href="#intermediate-memory-measurement" id="ref-for-intermediate-memory-measurement①">intermediate memory measurement</a> of <var>agent clusters</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task">Queue a global task</a> on the TODO task source given <var>promise</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve">resolve</a> <var>promise</var> with the result of <a data-link-type="dfn" href="#creating-a-new-memory-measurement" id="ref-for-creating-a-new-memory-measurement">creating a new memory measurement</a> given <var>intermediate memory measurement</var>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.3" id="converting-an-intermediate-memory-measurement-to-the-result"><span class="secno">3.3. </span><span class="content">Converting an intermediate memory measurement to the result</span><a class="self-link" href="#converting-an-intermediate-memory-measurement-to-the-result"></a></h3>
   <div class="algorithm" data-algorithm="creating a new memory measurement">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="creating a new memory measurement|create a new memory measurement" data-noexport id="creating-a-new-memory-measurement">create a new memory measurement</dfn> given an <a data-link-type="dfn" href="#intermediate-memory-measurement" id="ref-for-intermediate-memory-measurement②">intermediate memory measurement</a> <var>intermediate measurement</var>: 
    <ol>
     <li data-md>
      <p>Let <var>bytes</var> be 0.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry②">intermediate memory breakdown entry</a> <var>intermediate entry</var> in <var>intermediate measurement</var>:</p>
      <ol>
       <li data-md>
        <p>Set <var>bytes</var> to <var>bytes</var> plus <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-bytes" id="ref-for-intermediate-memory-breakdown-entry-bytes">bytes</a>.</p>
      </ol>
     <li data-md>
      <p>Let <var>breakdown</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate①">For each</a> <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry③">intermediate memory breakdown entry</a> <var>intermediate entry</var> in <var>intermediate measurement</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>breakdown entry</var> be the result of <a data-link-type="dfn" href="#creating-a-new-memory-breakdown-entry" id="ref-for-creating-a-new-memory-breakdown-entry">creating a new memory breakdown entry</a> given <var>intermediate entry</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>breakdown entry</var> to <var>breakdown</var>.</p>
      </ol>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement③">MemoryMeasurement</a></code> whose:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes②">bytes</a></code> is <var>bytes</var>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-breakdown" id="ref-for-dom-memorymeasurement-breakdown①">breakdown</a></code> is <var>breakdown</var>.</p>
      </ul>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="creating a new memory breakdown entry">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="creating a new memory breakdown entry|create a new memory breakdown entry" data-noexport id="creating-a-new-memory-breakdown-entry">create a new memory breakdown entry</dfn> given an <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry" id="ref-for-intermediate-memory-breakdown-entry④">intermediate memory breakdown entry</a> <var>intermediate entry</var>: 
    <ol>
     <li data-md>
      <p>Let <var>attribution</var> a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate②">For each</a> <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①①">JavaScript realm</a> <var>realm</var> in <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-realms" id="ref-for-intermediate-memory-breakdown-entry-realms">realms</a>:</p>
      <ol>
       <li data-md>
        <p>Let <var>attribution entry</var> be the result of <a data-link-type="dfn" href="#creating-a-new-memory-attribution" id="ref-for-creating-a-new-memory-attribution">creating a new memory attribution</a> given <var>realm</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">Append</a> <var>attribution entry</var> to <var>attribution</var>.</p>
      </ol>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry①">MemoryBreakdownEntry</a></code> whose:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes①">bytes</a></code> is <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-bytes" id="ref-for-intermediate-memory-breakdown-entry-bytes①">bytes</a>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution①">attribution</a></code> is <var>attribution</var>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-useragentspecifictypes" id="ref-for-dom-memorybreakdownentry-useragentspecifictypes①">userAgentSpecificTypes</a></code> is <var>intermediate entry</var>’s <a data-link-type="dfn" href="#intermediate-memory-breakdown-entry-user-agent-specific-types" id="ref-for-intermediate-memory-breakdown-entry-user-agent-specific-types">user agent specific types</a>.</p>
      </ul>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="creating a new memory attribution">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="creating a new memory attribution|create a new memory attribution" data-noexport id="creating-a-new-memory-attribution">create a new memory attribution</dfn> given a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①②">JavaScript realm</a> <var>realm</var>: 
    <ol>
     <li data-md>
      <p>Let <var>token</var> be <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global③">global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token">memory attribution token</a>.</p>
     <li data-md>
      <p>If <var>token</var>’s <a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag">cross-origin aggregated flag</a> is true, then</p>
      <ol>
       <li data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution①">MemoryAttribution</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url①">url</a></code> is "<code>cross-origin-url</code>",</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container①">container</a></code> is <var>token</var>’s <a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container">container</a> if it is not null; otherwise, the <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container②">container</a></code> entry is omitted,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope①">scope</a></code> is "<code>cross-origin-aggregated</code>".</p>
        </ul>
      </ol>
     <li data-md>
      <p>Let <var>scope name</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-identifier" id="ref-for-dfn-identifier">identifier</a> of <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global④">global object</a>'s <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-interface" id="ref-for-dfn-interface">interface</a>.</p>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution②">MemoryAttribution</a></code> whose:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url②">url</a></code> is <var>realm</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object" id="ref-for-concept-realm-settings-object①">settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" id="ref-for-concept-environment-creation-url">creation URL</a>,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container③">container</a></code> is <var>token</var>’s <a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container①">container</a> if it is not null, otherwise, the <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container④">container</a></code> entry is omitted,</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope②">scope</a></code> is <var>scope name</var>.</p>
      </ul>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.4" id="creating-or-obtaining-a-memory-attribution-token"><span class="secno">3.4. </span><span class="content">Creating or obtaining a memory attribution token</span><a class="self-link" href="#creating-or-obtaining-a-memory-attribution-token"></a></h3>
   <div class="algorithm" data-algorithm="obtain a window memory attribution token">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="obtain a window memory attribution token|obtaining a window memory attribution token" data-noexport id="obtain-a-window-memory-attribution-token">obtain a window memory attribution token</dfn> given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin">origin</a> <var>origin</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin①">origin</a> <var>parent origin</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin②">origin</a> <var>top-level origin</var>,
  an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement" id="ref-for-htmlelement">HTMLElement</a></code> <var>container element</var>, and a <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token">memory attribution token</a> <var>parent token</var>: 
    <ol>
     <li data-md>
      <p>If <var>container element</var> is null, then:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①">Assert</a>: <var>parent origin</var> is null.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert②">Assert</a>: <var>parent token</var> is null.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert③">Assert</a>: <var>origin</var> is equal to <var>parent origin</var></p>
       <li data-md>
        <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token①">memory attribution token</a> whose:</p>
        <ul>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container②">container</a> is null,</p>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag①">cross-origin aggregated flag</a> is false.</p>
        </ul>
      </ol>
     <li data-md>
      <p>Let <var>container</var> be the result of <a data-link-type="dfn" href="#extract-container-element-attributes" id="ref-for-extract-container-element-attributes">extracting container element attributes</a> given <var>container element</var>.</p>
     <li data-md>
      <p>If <var>origin</var> is equal to <var>top-level origin</var>, then:</p>
      <ol>
       <li data-md>
        <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token②">memory attribution token</a> whose:</p>
        <ul>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container③">container</a> is <var>container</var>,</p>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag②">cross-origin aggregated flag</a> is false.</p>
        </ul>
      </ol>
     <li data-md>
      <p>If <var>parent origin</var> is equal to <var>top-level origin</var>, then:</p>
      <ol>
       <li data-md>
        <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token③">memory attribution token</a> whose:</p>
        <ul>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container④">container</a> is <var>container</var>,</p>
         <li data-md>
          <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag③">cross-origin aggregated flag</a> is true.</p>
        </ul>
      </ol>
     <li data-md>
      <p>Return <var>parent token</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="obtain a worker memory attribution token">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="obtain a worker memory attribution token|obtaining a worker memory attribution token" data-noexport id="obtain-a-worker-memory-attribution-token">obtain a worker memory attribution token</dfn> given <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code> <var>worker global scope</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> <var>outside settings</var>: 
    <ol>
     <li data-md>
      <p>If <var>worker global scope</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a></code>, then
 return <var>outside settings</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token①">memory attribution token</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>worker global scope</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①">SharedWorkerGlobalScope</a></code> or a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①">ServiceWorkerGlobalScope</a></code>.</p>
     <li data-md>
      <p>Return a new <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token④">memory attribution token</a> whose:</p>
      <ul>
       <li data-md>
        <p><a data-link-type="dfn" href="#memory-attribution-token-container" id="ref-for-memory-attribution-token-container⑤">container</a> is null,</p>
       <li data-md>
        <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag" id="ref-for-memory-attribution-token-cross-origin-aggregated-flag④">cross-origin aggregated flag</a> is false.</p>
      </ul>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="extract container element attributes">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="extract container element attributes|extracting container element attributes" data-noexport id="extract-container-element-attributes">extract container element attributes</dfn> given an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement" id="ref-for-htmlelement①">HTMLElement</a></code> <var>container element</var>: 
    <ol>
     <li data-md>
      <p>Switch on <var>container element</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element-local-name" id="ref-for-concept-element-local-name">local name</a>:</p>
      <dl class="switch">
       <dt data-md>"iframe"
       <dd data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer②">MemoryAttributionContainer</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id①">id</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute">id</a></code> attribute,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src①">src</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src" id="ref-for-attr-iframe-src">src</a></code> attribute,</p>
        </ul>
       <dt data-md>"frame"
       <dd data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer③">MemoryAttributionContainer</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id②">id</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute①">id</a></code> attribute,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src②">src</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-frame-src" id="ref-for-dom-frame-src">src</a></code> attribute,</p>
        </ul>
       <dt data-md>"object"
       <dd data-md>
        <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer④">MemoryAttributionContainer</a></code> whose:</p>
        <ul>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id③">id</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute②">id</a></code> attribute,</p>
         <li data-md>
          <p><code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src③">src</a></code> is <var>container element</var>’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data①">data</a></code> attribute,</p>
        </ul>
      </dl>
    </ol>
   </div>
   <h2 class="heading settled" data-level="4" id="integration-with-the-existing-specification"><span class="secno">4. </span><span class="content">Integration with the existing specification</span><a class="self-link" href="#integration-with-the-existing-specification"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="extension-to-window-or-worker-global-scope"><span class="secno">4.1. </span><span class="content">Extension to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope①">WindowOrWorkerGlobalScope</a></code></span><a class="self-link" href="#extension-to-window-or-worker-global-scope"></a></h3>
    A new internal field is added to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope②">WindowOrWorkerGlobalScope</a></code>: 
   <dl>
    <dt data-md>A <dfn class="dfn-paneled" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="dfn" data-noexport id="windoworworkerglobalscope-memory-attribution-token">memory attribution token</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token⑤">memory attribution token</a> that is used for reporting the memory usage of this environment.</p>
   </dl>
   <h3 class="heading settled" data-level="4.2" id="extensions-to-the-existing-algorithms"><span class="secno">4.2. </span><span class="content">Extensions to the existing algorithms</span><a class="self-link" href="#extensions-to-the-existing-algorithms"></a></h3>
   <p>The <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker" id="ref-for-run-a-worker">run a worker</a> algorithm sets
the <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token②">memory attribution token</a> field of the newly created global object in step 6:</p>
   <blockquote>
    <ol start="6">
     <li data-md>
      <p>Let realm execution context be the result of creating a new JavaScript realm given agent
 and the following customizations:</p>
      <ul>
       <li data-md>
        <p>...</p>
       <li data-md>
        <p>Set global object’s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token③">memory attribution token</a> to the result of <a data-link-type="dfn" href="#obtain-a-worker-memory-attribution-token" id="ref-for-obtain-a-worker-memory-attribution-token">obtaining a worker memory attribution token</a> given
 the global object and <var>outside settings</var>.</p>
      </ul>
    </ol>
   </blockquote>
   <p>The <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object" id="ref-for-initialise-the-document-object">create and initialize a Document object</a> algorithm sets the <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token④">memory attribution token</a> field of the newly created global object:</p>
   <blockquote>
    <ol start="7">
     <li data-md>
      <p>Otherwise:</p>
      <ol start="5">
       <li data-md>
        <p>Let <var>token</var> be an empty <a data-link-type="dfn" href="#memory-attribution-token" id="ref-for-memory-attribution-token⑥">memory attribution token</a>.</p>
       <li data-md>
        <p>If <var>browsingContext</var> is not a top-level browsing context, then:</p>
        <ol start="4">
         <li data-md>
          <p>Let <var>parentToken</var> be <var>parentEnvironment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①">global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑤">memory attribution token</a>.</p>
         <li data-md>
          <p>Set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token">obtaining a window memory attribution token</a> with <var>origin</var>, <var>parentEnvironment</var>’s origin, <var>topLevelOrigin</var>, <var>browsingContext</var>’s container, <var>parentToken</var>.</p>
        </ol>
       <li data-md>
        <p>Else, set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token①">obtaining a window memory attribution token</a> with <var>origin</var>, null <var>topLevelOrigin</var>, null, null.</p>
       <li data-md>
        <p>Let <var>window global scope</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑤">global object</a> of <var>realm execution context</var>’s Realm component.</p>
       <li data-md>
        <p>Set <var>window global scope</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑥">memory attribution token</a> to <var>token</var>.</p>
      </ol>
    </ol>
   </blockquote>
   <p>The <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/browsers.html#creating-a-new-browsing-context" id="ref-for-creating-a-new-browsing-context">create a new browsing context</a> algorithm sets the <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑦">memory attribution token</a> field of the newly created global object:</p>
   <blockquote>
    <ol start="11">
     <li data-md>
      <p>Let <var>token</var> be an empty token.</p>
     <li data-md>
      <p>If <var>embedder</var> is null, then set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token②">obtaining a window memory attribution token</a> with <var>origin</var>,
  null, <var>topLevelOrigin</var>, null, null.</p>
     <li data-md>
      <p>Else, set <var>token</var> to the result of <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token" id="ref-for-obtain-a-window-memory-attribution-token③">obtaining a window memory attribution token</a> with <var>origin</var>, <var>embedder</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>'s origin, <var>topLevelOrigin</var>, <var>embedder</var>, <var>embedder</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a>'s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑧">memory attribution token</a>.</p>
     <li data-md>
      <p>Let <var>window global scope</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global" id="ref-for-concept-realm-global⑥">global object</a> of <var>realm execution context</var>’s Realm component.</p>
     <li data-md>
      <p>Set <var>window global scope</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token" id="ref-for-windoworworkerglobalscope-memory-attribution-token⑨">memory attribution token</a> to <var>token</var>.</p>
    </ol>
   </blockquote>
   <h2 class="heading settled" data-level="5" id="acknowledgements"><span class="secno">5. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    Thanks to Domenic Denicola and Shu-yu Guo for contributing to the API design and for reviewing this specification. 
   <p>Also thanks to Adam Giacobbe, Anne van Kesteren, Artur Janc, Boris Zbarsky, Chris Hamilton, Chris Palmer, Daniel Vogelheim, Dominik Inführ, Hannes Payer, Joe Mason, Kentaro Hara, L. David Baron, Mathias Bynens, Matthew Bolohan, Michael Lippautz, Mike West, Neil Mckay, Olga Belomestnykh, Per Parker, Philipp Weis, and Yoav Weiss for their feedback and contributions.</p>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-memorybreakdownentry-attribution">attribution</a><span>, in §2.1</span>
   <li><a href="#dom-memorymeasurement-breakdown">breakdown</a><span>, in §2.1</span>
   <li>
    bytes
    <ul>
     <li><a href="#intermediate-memory-breakdown-entry-bytes">dfn for intermediate memory breakdown entry</a><span>, in §2.2</span>
     <li><a href="#dom-memorybreakdownentry-bytes">dict-member for MemoryBreakdownEntry</a><span>, in §2.1</span>
     <li><a href="#dom-memorymeasurement-bytes">dict-member for MemoryMeasurement</a><span>, in §2.1</span>
    </ul>
   <li>
    container
    <ul>
     <li><a href="#memory-attribution-token-container">dfn for memory attribution token</a><span>, in §2.3</span>
     <li><a href="#dom-memoryattribution-container">dict-member for MemoryAttribution</a><span>, in §2.1</span>
    </ul>
   <li><a href="#creating-a-new-memory-attribution">create a new memory attribution</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-breakdown-entry">create a new memory breakdown entry</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-measurement">create a new memory measurement</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-attribution">creating a new memory attribution</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-breakdown-entry">creating a new memory breakdown entry</a><span>, in §3.3</span>
   <li><a href="#creating-a-new-memory-measurement">creating a new memory measurement</a><span>, in §3.3</span>
   <li><a href="#memory-attribution-token-cross-origin-aggregated-flag">cross-origin aggregated flag</a><span>, in §2.3</span>
   <li><a href="#extract-container-element-attributes">extract container element attributes</a><span>, in §3.4</span>
   <li><a href="#extract-container-element-attributes">extracting container element attributes</a><span>, in §3.4</span>
   <li><a href="#getting-all-agent-clusters">get all agent clusters</a><span>, in §3.2</span>
   <li><a href="#getting-all-agent-clusters">getting all agent clusters</a><span>, in §3.2</span>
   <li><a href="#dom-memoryattributioncontainer-id">id</a><span>, in §2.1</span>
   <li><a href="#implementation-defined-memory-measurement">implementation-defined memory measurement</a><span>, in §3.2</span>
   <li><a href="#intermediate-memory-breakdown-entry">intermediate memory breakdown entry</a><span>, in §2.2</span>
   <li><a href="#intermediate-memory-measurement">intermediate memory measurement</a><span>, in §2.2</span>
   <li><a href="#dom-performance-measurememory">measureMemory()</a><span>, in §3.2</span>
   <li><a href="#dictdef-memoryattribution">MemoryAttribution</a><span>, in §2.1</span>
   <li><a href="#dictdef-memoryattributioncontainer">MemoryAttributionContainer</a><span>, in §2.1</span>
   <li>
    memory attribution token
    <ul>
     <li><a href="#memory-attribution-token">definition of</a><span>, in §2.3</span>
     <li><a href="#windoworworkerglobalscope-memory-attribution-token">dfn for WindowOrWorkerGlobalScope</a><span>, in §4.1</span>
    </ul>
   <li><a href="#dictdef-memorybreakdownentry">MemoryBreakdownEntry</a><span>, in §2.1</span>
   <li><a href="#dictdef-memorymeasurement">MemoryMeasurement</a><span>, in §2.1</span>
   <li><a href="#memory-measurement-allowed-predicate">memory measurement allowed predicate</a><span>, in §3.2</span>
   <li><a href="#obtain-a-window-memory-attribution-token">obtain a window memory attribution token</a><span>, in §3.4</span>
   <li><a href="#obtain-a-worker-memory-attribution-token">obtain a worker memory attribution token</a><span>, in §3.4</span>
   <li><a href="#obtain-a-window-memory-attribution-token">obtaining a window memory attribution token</a><span>, in §3.4</span>
   <li><a href="#obtain-a-worker-memory-attribution-token">obtaining a worker memory attribution token</a><span>, in §3.4</span>
   <li><a href="#intermediate-memory-breakdown-entry-realms">realms</a><span>, in §2.2</span>
   <li><a href="#dom-memoryattribution-scope">scope</a><span>, in §2.1</span>
   <li><a href="#dom-memoryattributioncontainer-src">src</a><span>, in §2.1</span>
   <li><a href="#dom-memoryattribution-url">url</a><span>, in §2.1</span>
   <li><a href="#intermediate-memory-breakdown-entry-user-agent-specific-types">user agent specific types</a><span>, in §2.2</span>
   <li><a href="#dom-memorybreakdownentry-useragentspecifictypes">userAgentSpecificTypes</a><span>, in §2.1</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-concept-element-local-name">
   <a href="https://dom.spec.whatwg.org/#concept-element-local-name">https://dom.spec.whatwg.org/#concept-element-local-name</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-element-local-name">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-agents">
   <a href="https://tc39.es/ecma262/#sec-agents">https://tc39.es/ecma262/#sec-agents</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-agents">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agents①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-agent-clusters">
   <a href="https://tc39.es/ecma262/#sec-agent-clusters">https://tc39.es/ecma262/#sec-agent-clusters</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-agent-clusters">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-sec-agent-clusters①">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agent-clusters②">(2)</a> <a href="#ref-for-sec-agent-clusters③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-agent-clusters">
   <a href="https://tc39.es/ecma262/#sec-agent-clusters">https://tc39.es/ecma262/#sec-agent-clusters</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-agent-clusters">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-sec-agent-clusters①">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agent-clusters②">(2)</a> <a href="#ref-for-sec-agent-clusters③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-code-realms">
   <a href="https://tc39.es/ecma262/#sec-code-realms">https://tc39.es/ecma262/#sec-code-realms</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-code-realms">2.1. Memory measurement result</a> <a href="#ref-for-sec-code-realms①">(2)</a> <a href="#ref-for-sec-code-realms②">(3)</a> <a href="#ref-for-sec-code-realms③">(4)</a> <a href="#ref-for-sec-code-realms④">(5)</a>
    <li><a href="#ref-for-sec-code-realms⑤">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-sec-code-realms⑥">2.3. Memory attribution token</a> <a href="#ref-for-sec-code-realms⑦">(2)</a> <a href="#ref-for-sec-code-realms⑧">(3)</a>
    <li><a href="#ref-for-sec-code-realms⑨">3.2. Top-level algorithms</a> <a href="#ref-for-sec-code-realms①⓪">(2)</a>
    <li><a href="#ref-for-sec-code-realms①①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-sec-code-realms①②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-code-realms">
   <a href="https://tc39.es/ecma262/#sec-code-realms">https://tc39.es/ecma262/#sec-code-realms</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-code-realms">2.1. Memory measurement result</a> <a href="#ref-for-sec-code-realms①">(2)</a> <a href="#ref-for-sec-code-realms②">(3)</a> <a href="#ref-for-sec-code-realms③">(4)</a> <a href="#ref-for-sec-code-realms④">(5)</a>
    <li><a href="#ref-for-sec-code-realms⑤">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-sec-code-realms⑥">2.3. Memory attribution token</a> <a href="#ref-for-sec-code-realms⑦">(2)</a> <a href="#ref-for-sec-code-realms⑧">(3)</a>
    <li><a href="#ref-for-sec-code-realms⑨">3.2. Top-level algorithms</a> <a href="#ref-for-sec-code-realms①⓪">(2)</a>
    <li><a href="#ref-for-sec-code-realms①①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-sec-code-realms①②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-agent">
   <a href="https://tc39.es/ecma262/#sec-agent">https://tc39.es/ecma262/#sec-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-agent">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agent①">(2)</a> <a href="#ref-for-sec-agent②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-performance">
   <a href="https://w3c.github.io/hr-time/#sec-performance">https://w3c.github.io/hr-time/#sec-performance</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-performance">3.1. Extensions to the Performance interface</a> <a href="#ref-for-sec-performance①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dedicatedworkerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dedicatedworkerglobalscope">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlelement">
   <a href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement">https://html.spec.whatwg.org/multipage/dom.html#htmlelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlelement">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-htmlelement①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sharedworkerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedworkerglobalscope">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-sharedworkerglobalscope①">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window">https://html.spec.whatwg.org/multipage/window-object.html#window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window">3.2. Top-level algorithms</a> <a href="#ref-for-window①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-windoworworkerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope">https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windoworworkerglobalscope">2.3. Memory attribution token</a>
    <li><a href="#ref-for-windoworworkerglobalscope①">4.1. Extension to WindowOrWorkerGlobalScope</a> <a href="#ref-for-windoworworkerglobalscope②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-workerglobalscope">
   <a href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workerglobalscope">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window-bc">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window-bc">https://html.spec.whatwg.org/multipage/window-object.html#window-bc</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window-bc">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-browsing-context-group">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-context-group">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-creation-url">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-creation-url">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-attr-object-data">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attr-object-data">2.1. Memory measurement result</a>
    <li><a href="#ref-for-attr-object-data①">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-settings-object">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-global">3.4. Creating or obtaining a memory attribution token</a>
    <li><a href="#ref-for-concept-settings-object-global①">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-in-parallel">
   <a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-object-element">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-object-element">2.1. Memory measurement result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-origin">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-global-task">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-global-task">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-concept-relevant-global①">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relevant-settings-object">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-realm-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-realm-settings-object">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-concept-realm-settings-object①">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-attr-iframe-src">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attr-iframe-src">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-top-level-origin">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-append">
   <a href="https://infra.spec.whatwg.org/#list-append">https://infra.spec.whatwg.org/#list-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-append">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-list-append①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-assert">
   <a href="https://infra.spec.whatwg.org/#assert">https://infra.spec.whatwg.org/#assert</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assert">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-assert①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-assert②">(2)</a> <a href="#ref-for-assert③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-boolean">
   <a href="https://infra.spec.whatwg.org/#boolean">https://infra.spec.whatwg.org/#boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-boolean">2.3. Memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-iterate">
   <a href="https://infra.spec.whatwg.org/#list-iterate">https://infra.spec.whatwg.org/#list-iterate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-iterate">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-list-iterate①">(2)</a> <a href="#ref-for-list-iterate②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-getting-the-values">
   <a href="https://infra.spec.whatwg.org/#map-getting-the-values">https://infra.spec.whatwg.org/#map-getting-the-values</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-getting-the-values">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-implementation-defined">
   <a href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined">2.1. Memory measurement result</a>
    <li><a href="#ref-for-implementation-defined①">2.2. Intermediate memory measurement</a> <a href="#ref-for-implementation-defined②">(2)</a>
    <li><a href="#ref-for-implementation-defined③">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct-item">
   <a href="https://infra.spec.whatwg.org/#struct-item">https://infra.spec.whatwg.org/#struct-item</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct-item">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-struct-item①">2.3. Memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list">
   <a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-list①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
   <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-set">2.2. Intermediate memory measurement</a> <a href="#ref-for-ordered-set①">(2)</a> <a href="#ref-for-ordered-set②">(3)</a>
    <li><a href="#ref-for-ordered-set③">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string">
   <a href="https://infra.spec.whatwg.org/#string">https://infra.spec.whatwg.org/#string</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string">2.2. Intermediate memory measurement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct">
   <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-struct①">2.3. Memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-serviceworkerglobalscope">
   <a href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope">https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serviceworkerglobalscope">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-serviceworkerglobalscope①">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMException">
   <a href="https://heycam.github.io/webidl/#idl-DOMException">https://heycam.github.io/webidl/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
   <a href="https://heycam.github.io/webidl/#idl-DOMString">https://heycam.github.io/webidl/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">2.1. Memory measurement result</a> <a href="#ref-for-idl-DOMString①">(2)</a> <a href="#ref-for-idl-DOMString②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
   <a href="https://heycam.github.io/webidl/#idl-promise">https://heycam.github.io/webidl/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">1.1. Examples</a>
    <li><a href="#ref-for-idl-promise①">2.1. Memory measurement result</a>
    <li><a href="#ref-for-idl-promise②">3.2. Top-level algorithms</a> <a href="#ref-for-idl-promise③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-securityerror">
   <a href="https://heycam.github.io/webidl/#securityerror">https://heycam.github.io/webidl/#securityerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-securityerror">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
   <a href="https://heycam.github.io/webidl/#idl-USVString">https://heycam.github.io/webidl/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">2.1. Memory measurement result</a> <a href="#ref-for-idl-USVString①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-rejected-with">
   <a href="https://heycam.github.io/webidl/#a-promise-rejected-with">https://heycam.github.io/webidl/#a-promise-rejected-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-rejected-with">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-identifier">
   <a href="https://heycam.github.io/webidl/#dfn-identifier">https://heycam.github.io/webidl/#dfn-identifier</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-identifier">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-interface">
   <a href="https://heycam.github.io/webidl/#dfn-interface">https://heycam.github.io/webidl/#dfn-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-interface">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-resolve">
   <a href="https://heycam.github.io/webidl/#resolve">https://heycam.github.io/webidl/#resolve</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-resolve">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-unsigned-long-long">
   <a href="https://heycam.github.io/webidl/#idl-unsigned-long-long">https://heycam.github.io/webidl/#idl-unsigned-long-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unsigned-long-long">2.1. Memory measurement result</a> <a href="#ref-for-idl-unsigned-long-long①">(2)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-element-local-name" style="color:initial">local name</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMASCRIPT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-sec-agents" style="color:initial">agent</span>
     <li><span class="dfn-paneled" id="term-for-sec-agent-clusters" style="color:initial">agent cluster <small>(for agent)</small></span>
     <li><span class="dfn-paneled" id="term-for-sec-agent-clusters①" style="color:initial">javascript agent clusters</span>
     <li><span class="dfn-paneled" id="term-for-sec-code-realms" style="color:initial">javascript realm</span>
     <li><span class="dfn-paneled" id="term-for-sec-code-realms①" style="color:initial">javascript realms</span>
     <li><span class="dfn-paneled" id="term-for-sec-agent" style="color:initial">the current realm</span>
    </ul>
   <li>
    <a data-link-type="biblio">[hr-time-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-sec-performance" style="color:initial">Performance</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dedicatedworkerglobalscope" style="color:initial">DedicatedWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-htmlelement" style="color:initial">HTMLElement</span>
     <li><span class="dfn-paneled" id="term-for-sharedworkerglobalscope" style="color:initial">SharedWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-window" style="color:initial">Window</span>
     <li><span class="dfn-paneled" id="term-for-windoworworkerglobalscope" style="color:initial">WindowOrWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-workerglobalscope" style="color:initial">WorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="term-for-window-bc" style="color:initial">browsing context</span>
     <li><span class="dfn-paneled" id="term-for-browsing-context-group" style="color:initial">browsing context group</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-creation-url" style="color:initial">creation url</span>
     <li><span class="dfn-paneled" id="term-for-attr-object-data" style="color:initial">data</span>
     <li><span class="dfn-paneled" id="term-for-environment-settings-object" style="color:initial">environment settings object</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-global" style="color:initial">global object <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="term-for-in-parallel" style="color:initial">in parallel</span>
     <li><span class="dfn-paneled" id="term-for-the-object-element" style="color:initial">object</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-origin" style="color:initial">origin <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="term-for-queue-a-global-task" style="color:initial">queue a global task</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-global" style="color:initial">relevant global object</span>
     <li><span class="dfn-paneled" id="term-for-relevant-settings-object" style="color:initial">relevant settings object</span>
     <li><span class="dfn-paneled" id="term-for-concept-realm-settings-object" style="color:initial">settings object</span>
     <li><span class="dfn-paneled" id="term-for-attr-iframe-src" style="color:initial">src</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-origin" style="color:initial">top-level origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-list-append" style="color:initial">append</span>
     <li><span class="dfn-paneled" id="term-for-assert" style="color:initial">assert</span>
     <li><span class="dfn-paneled" id="term-for-boolean" style="color:initial">boolean</span>
     <li><span class="dfn-paneled" id="term-for-list-iterate" style="color:initial">for each</span>
     <li><span class="dfn-paneled" id="term-for-map-getting-the-values" style="color:initial">getting the values</span>
     <li><span class="dfn-paneled" id="term-for-implementation-defined" style="color:initial">implementation-defined</span>
     <li><span class="dfn-paneled" id="term-for-struct-item" style="color:initial">item</span>
     <li><span class="dfn-paneled" id="term-for-list" style="color:initial">list</span>
     <li><span class="dfn-paneled" id="term-for-ordered-set" style="color:initial">set</span>
     <li><span class="dfn-paneled" id="term-for-string" style="color:initial">string</span>
     <li><span class="dfn-paneled" id="term-for-struct" style="color:initial">struct</span>
    </ul>
   <li>
    <a data-link-type="biblio">[service-workers-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-serviceworkerglobalscope" style="color:initial">ServiceWorkerGlobalScope</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-DOMException" style="color:initial">DOMException</span>
     <li><span class="dfn-paneled" id="term-for-idl-DOMString" style="color:initial">DOMString</span>
     <li><span class="dfn-paneled" id="term-for-idl-promise" style="color:initial">Promise</span>
     <li><span class="dfn-paneled" id="term-for-securityerror" style="color:initial">SecurityError</span>
     <li><span class="dfn-paneled" id="term-for-idl-USVString" style="color:initial">USVString</span>
     <li><span class="dfn-paneled" id="term-for-a-promise-rejected-with" style="color:initial">a promise rejected with</span>
     <li><span class="dfn-paneled" id="term-for-dfn-identifier" style="color:initial">identifier</span>
     <li><span class="dfn-paneled" id="term-for-dfn-interface" style="color:initial">interface</span>
     <li><span class="dfn-paneled" id="term-for-resolve" style="color:initial">resolve</span>
     <li><span class="dfn-paneled" id="term-for-idl-unsigned-long-long" style="color:initial">unsigned long long</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-ecmascript">[ECMASCRIPT]
   <dd><a href="https://tc39.es/ecma262/">ECMAScript Language Specification</a>. URL: <a href="https://tc39.es/ecma262/">https://tc39.es/ecma262/</a>
   <dt id="biblio-hr-time-2">[HR-TIME-2]
   <dd>Ilya Grigorik. <a href="https://w3c.github.io/hr-time/">High Resolution Time Level 2</a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-service-workers-1">[SERVICE-WORKERS-1]
   <dd>Alex Russell; et al. <a href="https://w3c.github.io/ServiceWorker/">Service Workers 1</a>. URL: <a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Boris Zbarsky. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>dictionary</c-> <a href="#dictdef-memorymeasurement"><code><c- g>MemoryMeasurement</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long " href="#dom-memorymeasurement-bytes"><code><c- g>bytes</c-></code></a>;
  <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name" href="#dictdef-memorybreakdownentry"><c- n>MemoryBreakdownEntry</c-></a>> <a data-type="sequence<MemoryBreakdownEntry> " href="#dom-memorymeasurement-breakdown"><code><c- g>breakdown</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memorybreakdownentry"><code><c- g>MemoryBreakdownEntry</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long " href="#dom-memorybreakdownentry-bytes"><code><c- g>bytes</c-></code></a>;
  <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name" href="#dictdef-memoryattribution"><c- n>MemoryAttribution</c-></a>> <a data-type="sequence<MemoryAttribution> " href="#dom-memorybreakdownentry-attribution"><code><c- g>attribution</c-></code></a>;
  <c- b>sequence</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a>> <a data-type="sequence<DOMString> " href="#dom-memorybreakdownentry-useragentspecifictypes"><code><c- g>userAgentSpecificTypes</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memoryattribution"><code><c- g>MemoryAttribution</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-memoryattribution-url"><code><c- g>url</c-></code></a>;
  <a class="n" data-link-type="idl-name" href="#dictdef-memoryattributioncontainer"><c- n>MemoryAttributionContainer</c-></a> <a data-type="MemoryAttributionContainer " href="#dom-memoryattribution-container"><code><c- g>container</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-memoryattribution-scope"><code><c- g>scope</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memoryattributioncontainer"><code><c- g>MemoryAttributionContainer</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-memoryattributioncontainer-id"><code><c- g>id</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-memoryattributioncontainer-src"><code><c- g>src</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/hr-time/#sec-performance"><c- g>Performance</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://github.com/heycam/webidl#pull/883"><c- g>CrossOriginIsolated</c-></a>] <c- b>Promise</c->&lt;<a class="n" data-link-type="idl-name" href="#dictdef-memorymeasurement"><c- n>MemoryMeasurement</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-performance-measurememory"><c- g>measureMemory</c-></a>();
};

</pre>
  <aside class="dfn-panel" data-for="dictdef-memorymeasurement">
   <b><a href="#dictdef-memorymeasurement">#dictdef-memorymeasurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memorymeasurement">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memorymeasurement①">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-dictdef-memorymeasurement②">3.1. Extensions to the Performance interface</a>
    <li><a href="#ref-for-dictdef-memorymeasurement③">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorymeasurement-bytes">
   <b><a href="#dom-memorymeasurement-bytes">#dom-memorymeasurement-bytes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorymeasurement-bytes">2.1. Memory measurement result</a> <a href="#ref-for-dom-memorymeasurement-bytes①">(2)</a>
    <li><a href="#ref-for-dom-memorymeasurement-bytes②">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorymeasurement-breakdown">
   <b><a href="#dom-memorymeasurement-breakdown">#dom-memorymeasurement-breakdown</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorymeasurement-breakdown">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorymeasurement-breakdown①">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-memorybreakdownentry">
   <b><a href="#dictdef-memorybreakdownentry">#dictdef-memorybreakdownentry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memorybreakdownentry">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memorybreakdownentry①">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorybreakdownentry-bytes">
   <b><a href="#dom-memorybreakdownentry-bytes">#dom-memorybreakdownentry-bytes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorybreakdownentry-bytes">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorybreakdownentry-bytes①">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorybreakdownentry-attribution">
   <b><a href="#dom-memorybreakdownentry-attribution">#dom-memorybreakdownentry-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorybreakdownentry-attribution">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorybreakdownentry-attribution①">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memorybreakdownentry-useragentspecifictypes">
   <b><a href="#dom-memorybreakdownentry-useragentspecifictypes">#dom-memorybreakdownentry-useragentspecifictypes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memorybreakdownentry-useragentspecifictypes">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memorybreakdownentry-useragentspecifictypes①">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-memoryattribution">
   <b><a href="#dictdef-memoryattribution">#dictdef-memoryattribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memoryattribution">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memoryattribution①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dictdef-memoryattribution②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattribution-url">
   <b><a href="#dom-memoryattribution-url">#dom-memoryattribution-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattribution-url">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattribution-url①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memoryattribution-url②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattribution-container">
   <b><a href="#dom-memoryattribution-container">#dom-memoryattribution-container</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattribution-container">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattribution-container①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memoryattribution-container②">(2)</a> <a href="#ref-for-dom-memoryattribution-container③">(3)</a> <a href="#ref-for-dom-memoryattribution-container④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattribution-scope">
   <b><a href="#dom-memoryattribution-scope">#dom-memoryattribution-scope</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattribution-scope">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattribution-scope①">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-dom-memoryattribution-scope②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-memoryattributioncontainer">
   <b><a href="#dictdef-memoryattributioncontainer">#dictdef-memoryattributioncontainer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-memoryattributioncontainer">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dictdef-memoryattributioncontainer①">2.3. Memory attribution token</a>
    <li><a href="#ref-for-dictdef-memoryattributioncontainer②">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-dictdef-memoryattributioncontainer③">(2)</a> <a href="#ref-for-dictdef-memoryattributioncontainer④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattributioncontainer-id">
   <b><a href="#dom-memoryattributioncontainer-id">#dom-memoryattributioncontainer-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattributioncontainer-id">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattributioncontainer-id①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-dom-memoryattributioncontainer-id②">(2)</a> <a href="#ref-for-dom-memoryattributioncontainer-id③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-memoryattributioncontainer-src">
   <b><a href="#dom-memoryattributioncontainer-src">#dom-memoryattributioncontainer-src</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-memoryattributioncontainer-src">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-memoryattributioncontainer-src①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-dom-memoryattributioncontainer-src②">(2)</a> <a href="#ref-for-dom-memoryattributioncontainer-src③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-measurement">
   <b><a href="#intermediate-memory-measurement">#intermediate-memory-measurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-measurement">2.2. Intermediate memory measurement</a>
    <li><a href="#ref-for-intermediate-memory-measurement①">3.2. Top-level algorithms</a>
    <li><a href="#ref-for-intermediate-memory-measurement②">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry">
   <b><a href="#intermediate-memory-breakdown-entry">#intermediate-memory-breakdown-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry">2.2. Intermediate memory measurement</a> <a href="#ref-for-intermediate-memory-breakdown-entry①">(2)</a>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry②">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-intermediate-memory-breakdown-entry③">(2)</a> <a href="#ref-for-intermediate-memory-breakdown-entry④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-bytes">
   <b><a href="#intermediate-memory-breakdown-entry-bytes">#intermediate-memory-breakdown-entry-bytes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry-bytes">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-intermediate-memory-breakdown-entry-bytes①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-realms">
   <b><a href="#intermediate-memory-breakdown-entry-realms">#intermediate-memory-breakdown-entry-realms</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry-realms">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-user-agent-specific-types">
   <b><a href="#intermediate-memory-breakdown-entry-user-agent-specific-types">#intermediate-memory-breakdown-entry-user-agent-specific-types</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intermediate-memory-breakdown-entry-user-agent-specific-types">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-attribution-token">
   <b><a href="#memory-attribution-token">#memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-attribution-token">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-memory-attribution-token①">(2)</a> <a href="#ref-for-memory-attribution-token②">(3)</a> <a href="#ref-for-memory-attribution-token③">(4)</a> <a href="#ref-for-memory-attribution-token④">(5)</a>
    <li><a href="#ref-for-memory-attribution-token⑤">4.1. Extension to WindowOrWorkerGlobalScope</a>
    <li><a href="#ref-for-memory-attribution-token⑥">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-attribution-token-container">
   <b><a href="#memory-attribution-token-container">#memory-attribution-token-container</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-attribution-token-container">3.3. Converting an intermediate memory measurement to the result</a> <a href="#ref-for-memory-attribution-token-container①">(2)</a>
    <li><a href="#ref-for-memory-attribution-token-container②">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-memory-attribution-token-container③">(2)</a> <a href="#ref-for-memory-attribution-token-container④">(3)</a> <a href="#ref-for-memory-attribution-token-container⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-attribution-token-cross-origin-aggregated-flag">
   <b><a href="#memory-attribution-token-cross-origin-aggregated-flag">#memory-attribution-token-cross-origin-aggregated-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag">3.3. Converting an intermediate memory measurement to the result</a>
    <li><a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag①">3.4. Creating or obtaining a memory attribution token</a> <a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag②">(2)</a> <a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag③">(3)</a> <a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-performance-measurememory">
   <b><a href="#dom-performance-measurememory">#dom-performance-measurememory</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-performance-measurememory">1. Introduction</a>
    <li><a href="#ref-for-dom-performance-measurememory①">1.1. Examples</a> <a href="#ref-for-dom-performance-measurememory②">(2)</a>
    <li><a href="#ref-for-dom-performance-measurememory③">2.1. Memory measurement result</a>
    <li><a href="#ref-for-dom-performance-measurememory④">3.1. Extensions to the Performance interface</a> <a href="#ref-for-dom-performance-measurememory⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="memory-measurement-allowed-predicate">
   <b><a href="#memory-measurement-allowed-predicate">#memory-measurement-allowed-predicate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-memory-measurement-allowed-predicate">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="getting-all-agent-clusters">
   <b><a href="#getting-all-agent-clusters">#getting-all-agent-clusters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-getting-all-agent-clusters">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="implementation-defined-memory-measurement">
   <b><a href="#implementation-defined-memory-measurement">#implementation-defined-memory-measurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined-memory-measurement">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="creating-a-new-memory-measurement">
   <b><a href="#creating-a-new-memory-measurement">#creating-a-new-memory-measurement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-creating-a-new-memory-measurement">3.2. Top-level algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="creating-a-new-memory-breakdown-entry">
   <b><a href="#creating-a-new-memory-breakdown-entry">#creating-a-new-memory-breakdown-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-creating-a-new-memory-breakdown-entry">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="creating-a-new-memory-attribution">
   <b><a href="#creating-a-new-memory-attribution">#creating-a-new-memory-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-creating-a-new-memory-attribution">3.3. Converting an intermediate memory measurement to the result</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-window-memory-attribution-token">
   <b><a href="#obtain-a-window-memory-attribution-token">#obtain-a-window-memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-window-memory-attribution-token">4.2. Extensions to the existing algorithms</a> <a href="#ref-for-obtain-a-window-memory-attribution-token①">(2)</a> <a href="#ref-for-obtain-a-window-memory-attribution-token②">(3)</a> <a href="#ref-for-obtain-a-window-memory-attribution-token③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-worker-memory-attribution-token">
   <b><a href="#obtain-a-worker-memory-attribution-token">#obtain-a-worker-memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-worker-memory-attribution-token">4.2. Extensions to the existing algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="extract-container-element-attributes">
   <b><a href="#extract-container-element-attributes">#extract-container-element-attributes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-extract-container-element-attributes">3.4. Creating or obtaining a memory attribution token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windoworworkerglobalscope-memory-attribution-token">
   <b><a href="#windoworworkerglobalscope-memory-attribution-token">#windoworworkerglobalscope-memory-attribution-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token">3.3. Converting an intermediate memory measurement to the result</a>
    <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token①">3.4. Creating or obtaining a memory attribution token</a>
    <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token②">4.2. Extensions to the existing algorithms</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token③">(2)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token④">(3)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑤">(4)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑥">(5)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑦">(6)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑧">(7)</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑨">(8)</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    {
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s| )+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>